<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>campuscatbook 项目总结 | Mark&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="个人博客">
    <meta name="keywords" content="前端博客,mark">
    <link rel="preload" href="/assets/css/0.styles.84987be6.css" as="style"><link rel="preload" href="/assets/js/app.3e4d0eed.js" as="script"><link rel="preload" href="/assets/js/2.68aca893.js" as="script"><link rel="preload" href="/assets/js/24.4bf67378.js" as="script"><link rel="prefetch" href="/assets/js/10.a9ff179f.js"><link rel="prefetch" href="/assets/js/11.b7a3e839.js"><link rel="prefetch" href="/assets/js/12.87313dfa.js"><link rel="prefetch" href="/assets/js/13.1ce0f3e9.js"><link rel="prefetch" href="/assets/js/14.3be2a475.js"><link rel="prefetch" href="/assets/js/15.9c338a9c.js"><link rel="prefetch" href="/assets/js/16.e329f9d4.js"><link rel="prefetch" href="/assets/js/17.e9295561.js"><link rel="prefetch" href="/assets/js/18.f1c319e0.js"><link rel="prefetch" href="/assets/js/19.da289b65.js"><link rel="prefetch" href="/assets/js/20.8a61d6bd.js"><link rel="prefetch" href="/assets/js/21.38e2dda9.js"><link rel="prefetch" href="/assets/js/22.38f90f15.js"><link rel="prefetch" href="/assets/js/23.c140781e.js"><link rel="prefetch" href="/assets/js/25.e62002b0.js"><link rel="prefetch" href="/assets/js/26.37c2aacd.js"><link rel="prefetch" href="/assets/js/27.36bcaeeb.js"><link rel="prefetch" href="/assets/js/3.d104a03d.js"><link rel="prefetch" href="/assets/js/4.a6f13a86.js"><link rel="prefetch" href="/assets/js/5.9038bd49.js"><link rel="prefetch" href="/assets/js/6.f0c06a32.js"><link rel="prefetch" href="/assets/js/7.d806bef0.js"><link rel="prefetch" href="/assets/js/8.0617fe87.js"><link rel="prefetch" href="/assets/js/9.ce94c0df.js">
    <link rel="stylesheet" href="/assets/css/0.styles.84987be6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Mark's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide.html" class="nav-link">
  导航
</a></li><li class="dropdown-item"><!----> <a href="/Notes.html" class="nav-link">
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/Summaries.html" class="nav-link">
  总结
</a></li><li class="dropdown-item"><!----> <a href="/Articles.html" class="nav-link">
  文章
</a></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/Galileo01" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide.html" class="nav-link">
  导航
</a></li><li class="dropdown-item"><!----> <a href="/Notes.html" class="nav-link">
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/Summaries.html" class="nav-link">
  总结
</a></li><li class="dropdown-item"><!----> <a href="/Articles.html" class="nav-link">
  文章
</a></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/Galileo01" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>campuscatbook 项目总结</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/campus_cat_book.html#campus-cat-book-项目总结" class="sidebar-link">campuscatbook 项目总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/summary/campus_cat_book.html#_1-初始化wepy" class="sidebar-link">1.初始化wepy</a></li><li class="sidebar-sub-header"><a href="/summary/campus_cat_book.html#_2-选择组件库" class="sidebar-link">2.选择组件库</a></li><li class="sidebar-sub-header"><a href="/summary/campus_cat_book.html#_3-开始设计功能和页面" class="sidebar-link">3.开始设计功能和页面</a></li><li class="sidebar-sub-header"><a href="/summary/campus_cat_book.html#_4-项目配置" class="sidebar-link">4.项目配置</a></li><li class="sidebar-sub-header"><a href="/summary/campus_cat_book.html#_5-项目优化" class="sidebar-link">5.项目优化</a></li><li class="sidebar-sub-header"><a href="/summary/campus_cat_book.html#_6-项目经验" class="sidebar-link">6. 项目经验</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="campus-cat-book-项目总结"><a href="#campus-cat-book-项目总结" class="header-anchor">#</a> campus_cat_book 项目总结</h2> <p>技术栈：</p> <p>前端：wepy框架+vant 组件库 <a href="https://github.com/Galileo01/campus_cat_book" target="_blank" rel="noopener noreferrer">github仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>后端：node/express ，mongodb  <a href="https://github.com/Galileo01/campus_cat_book_backend" target="_blank" rel="noopener noreferrer">github仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>通过wepy 可以使用类似于 Vue的语法书写代码</p> <h3 id="_1-初始化wepy"><a href="#_1-初始化wepy" class="header-anchor">#</a> 1.初始化wepy</h3> <p>按照wepy 官网的<a href="https://wepyjs.github.io/wepy-docs/2.x/#/base/getstart" target="_blank" rel="noopener noreferrer">教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 安装wepy-cli，使用模板创建一个wepy项目 ，</p> <ul><li>删除一些没有必要的文件</li> <li>按照自己之前写Vue的文件结构，参照 官网的 <a href="https://wepyjs.github.io/wepy-docs/2.x/#/cli/config" target="_blank" rel="noopener noreferrer">配置文件讲解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 重新构建文件结构</li> <li>随便写一些代码，测试能否正常运行</li> <li>浏览文档，常识编写简单页面</li></ul> <h3 id="_2-选择组件库"><a href="#_2-选择组件库" class="header-anchor">#</a> 2.选择组件库</h3> <p>参照<a href="https://www.ifanr.com/minapp/1196588" target="_blank" rel="noopener noreferrer">文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 选择了vant 组件库，</p> <ul><li>vant的组件在浏览器可以直接预览，不需要打开微信小程序</li> <li>比较喜欢vant 总体偏蓝的风格，主色调和element 差不多</li> <li>也和iview对比例一下 引入组件的方式，vant 的比较方便</li> <li>查看官方文档，各个组件，</li></ul> <h3 id="_3-开始设计功能和页面"><a href="#_3-开始设计功能和页面" class="header-anchor">#</a> 3.开始设计功能和页面</h3> <ul><li><p>编写功能介绍md</p> <p>本来打算画一个脑图的</p></li> <li><p>使用墨刀 在线设计小程序的界面和各个页面的跳转</p></li></ul> <h3 id="_4-项目配置"><a href="#_4-项目配置" class="header-anchor">#</a> 4.项目配置</h3> <ul><li><p>引入vant 组件库</p> <p>npm install</p> <p>安装完依赖后，把 <strong>node_modules/_@vant_weapp/lib</strong> 的内容拷贝到 src/components/vant（或者先拷贝lib文件夹再改名）</p> <p>本项目中组件的引用方式都是 <strong>components/vant/xxx</strong></p></li> <li><p>wepy.config.js的配置</p> <ol><li>路径别名</li></ol></li></ul> <div class="language-js extra-class"><pre class="language-js"><code> alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'@'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">'assets'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/assets'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">'common'</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/common'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">'network'</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/network'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">'components'</span><span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/components'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><ol start="2"><li><p>静态资源位置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">static</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src/assets'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div></li></ol> <h3 id="_5-项目优化"><a href="#_5-项目优化" class="header-anchor">#</a> 5.项目优化</h3> <ol><li>合并setData</li></ol> <h3 id="_6-项目经验"><a href="#_6-项目经验" class="header-anchor">#</a> 6. 项目经验</h3> <ol><li><p>在wepy 框架内，<strong>依然可以使用 原生的语法</strong></p> <ul><li><p>在html 结构中</p> <p>比如 使用 value=&quot;&quot;等</p></li> <li><p>在方法或生命周期函数中</p> <p>依然可以使用<strong>wx.xxx访问全局Api</strong></p> <p>而  vm.$wx  指向 原生this   ，过 <code>this.$wx.setData</code>访问到<code>setData</code></p></li></ul></li> <li><p>wepy 和 原生的 model:xxx=&quot;aaa&quot; 双向数据绑定并不兼容</p> <p>当在 wepy html 结构中，使用  <strong>model:xxx=&quot;aaa&quot;</strong> 指令，视图层 可以做到 双向绑定，但是 模型层的 data 并没有更新，</p> <p>对于 input 表单而言，需要自己 绑定 change/input 事件，动态的 更改 data 状态</p></li> <li><p><strong>this.$navigate</strong> 跳转页面</p></li> <li><p>在2.0 之后 wepy.request 被废弃，需要开发者自己封装 网络请求</p></li></ol> <p>以下是我基于wx.request 封装的 http 类</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//封装 网络请求的 基础方法</span>
<span class="token keyword">class</span> <span class="token class-name">http</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> baseURL<span class="token punctuation">,</span> timeout <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_header <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'content-type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>baseURL <span class="token operator">=</span> baseURL <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>timeout <span class="token operator">=</span> timeout <span class="token operator">||</span> <span class="token number">500</span><span class="token punctuation">;</span><span class="token comment">//超时时间 默认500ms</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> header<span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">delete</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> header<span class="token punctuation">,</span> <span class="token string">'DELETE'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">put</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> header</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> header<span class="token punctuation">,</span> <span class="token string">'PUT'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> header</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> header<span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">request</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> header<span class="token punctuation">,</span> method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                url<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseURL <span class="token operator">+</span> url<span class="token punctuation">,</span>
                data<span class="token operator">:</span> data<span class="token punctuation">,</span>
                header<span class="token operator">:</span> header <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_header<span class="token punctuation">,</span>
                method<span class="token operator">:</span> method<span class="token punctuation">,</span>
                success<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>statusCode <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">//200: 服务端业务处理正常结束</span>
                        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                            data<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                            title<span class="token operator">:</span> <span class="token string">'请求失败'</span><span class="token punctuation">,</span>
                            icon<span class="token operator">:</span> <span class="token string">'none'</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token function">reject</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                fail<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        title<span class="token operator">:</span> <span class="token string">'请求失败'</span><span class="token punctuation">,</span>
                        icon<span class="token operator">:</span> <span class="token string">'none'</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> http

</code></pre></div><ol start="5"><li><p>由于小程序自身限制 <strong>无法在wxml 渲染时 {{}}内不能直接调用逻辑层的方法</strong></p> <p>定义在methods 里的方法不能在 wxml 中通过{{}}直接调用，  只能转为<strong>computed</strong> ，或者使用<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/interactive-animation.html" target="_blank" rel="noopener noreferrer"><strong>wxs</strong> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
使用wxs 减少通信的次数，<strong>让事件在视图层（Webview）响应</strong></p></li> <li><p>微信内的图片上传</p> <p>由于原生微信的限制，</p> <ul><li><p>原生不支持 formData Api</p> <p>不能通过手动new formData  来提交 content-type<code>为</code>multipart/form-data 类型的请求，一种常用的业务场景就是文件提交</p></li> <li><p>wx.uploadFile（）  一次只支持上传一个媒体文件</p> <p>这就需要后台编写 继续上传的 接口，接收剩下的 文件</p></li></ul></li> <li><p>小程序的 请求域名配置</p> <p><img src="https://cdn.jsdelivr.net/gh/Galileo01/imgCloud@master/image-20200913150230486.png" alt="image-20200913150230486"></p> <p>​     需要注意的是：不支持ip，</p> <p>​	在实际开发中，我的后台 部署在http 服务的8080端口上，除非关闭 域名的交延，否则无法正常的 使用，这时就需要 <strong>将express 升级到http</strong></p> <p>更多资料</p> <p><a href="http://nodejs.cn/api/https.html#https_https_createserver_options_requestlistener" target="_blank" rel="noopener noreferrer">1.node 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://blog.csdn.net/weixin_34414650/article/details/91385830" target="_blank" rel="noopener noreferrer">2 博文<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>后台 项目app.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> https<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> mongodbUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./commonjs/mongodbUtils'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./router/index'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> options<span class="token operator">=</span><span class="token punctuation">{</span>
    key<span class="token operator">:</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./certificate/markjoe.xyz.key'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    cert<span class="token operator">:</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./certificate/markjoe.xyz.crt'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//使用证书和 密钥文件 创建 https 服务</span>
<span class="token keyword">const</span> server<span class="token operator">=</span>https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">//连接数据库</span>
mongodbUtils<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//挂载路由</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/public'</span><span class="token punctuation">,</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>

<span class="token comment">// app.listen(8080, () =&gt; {</span>
<span class="token comment">//     console.log('server is running at 8080');</span>
<span class="token comment">// });</span>



server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'server is running at 8080'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/27/2020, 12:37:33 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.3e4d0eed.js" defer></script><script src="/assets/js/2.68aca893.js" defer></script><script src="/assets/js/24.4bf67378.js" defer></script>
  </body>
</html>

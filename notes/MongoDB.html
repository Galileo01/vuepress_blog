<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDB å­¦ä¹ ç¬”è®° | Mark&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="ä¸ªäººåšå®¢">
    <meta name="keywords" content="å‰ç«¯åšå®¢,mark">
    <link rel="preload" href="/assets/css/0.styles.84987be6.css" as="style"><link rel="preload" href="/assets/js/app.3e4d0eed.js" as="script"><link rel="preload" href="/assets/js/2.68aca893.js" as="script"><link rel="preload" href="/assets/js/15.9c338a9c.js" as="script"><link rel="prefetch" href="/assets/js/10.a9ff179f.js"><link rel="prefetch" href="/assets/js/11.b7a3e839.js"><link rel="prefetch" href="/assets/js/12.87313dfa.js"><link rel="prefetch" href="/assets/js/13.1ce0f3e9.js"><link rel="prefetch" href="/assets/js/14.3be2a475.js"><link rel="prefetch" href="/assets/js/16.e329f9d4.js"><link rel="prefetch" href="/assets/js/17.e9295561.js"><link rel="prefetch" href="/assets/js/18.f1c319e0.js"><link rel="prefetch" href="/assets/js/19.da289b65.js"><link rel="prefetch" href="/assets/js/20.8a61d6bd.js"><link rel="prefetch" href="/assets/js/21.38e2dda9.js"><link rel="prefetch" href="/assets/js/22.38f90f15.js"><link rel="prefetch" href="/assets/js/23.c140781e.js"><link rel="prefetch" href="/assets/js/24.4bf67378.js"><link rel="prefetch" href="/assets/js/25.e62002b0.js"><link rel="prefetch" href="/assets/js/26.37c2aacd.js"><link rel="prefetch" href="/assets/js/27.36bcaeeb.js"><link rel="prefetch" href="/assets/js/3.d104a03d.js"><link rel="prefetch" href="/assets/js/4.a6f13a86.js"><link rel="prefetch" href="/assets/js/5.9038bd49.js"><link rel="prefetch" href="/assets/js/6.f0c06a32.js"><link rel="prefetch" href="/assets/js/7.d806bef0.js"><link rel="prefetch" href="/assets/js/8.0617fe87.js"><link rel="prefetch" href="/assets/js/9.ce94c0df.js">
    <link rel="stylesheet" href="/assets/css/0.styles.84987be6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Mark's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åˆ†ç±»" class="dropdown-title"><span class="title">åˆ†ç±»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide.html" class="nav-link">
  å¯¼èˆª
</a></li><li class="dropdown-item"><!----> <a href="/Notes.html" class="nav-link">
  ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/Summaries.html" class="nav-link">
  æ€»ç»“
</a></li><li class="dropdown-item"><!----> <a href="/Articles.html" class="nav-link">
  æ–‡ç« 
</a></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">
  å…³äº
</a></div><div class="nav-item"><a href="https://github.com/Galileo01" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åˆ†ç±»" class="dropdown-title"><span class="title">åˆ†ç±»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide.html" class="nav-link">
  å¯¼èˆª
</a></li><li class="dropdown-item"><!----> <a href="/Notes.html" class="nav-link">
  ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/Summaries.html" class="nav-link">
  æ€»ç»“
</a></li><li class="dropdown-item"><!----> <a href="/Articles.html" class="nav-link">
  æ–‡ç« 
</a></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">
  å…³äº
</a></div><div class="nav-item"><a href="https://github.com/Galileo01" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MongoDB å­¦ä¹ ç¬”è®°</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/MongoDB.html#mongodb" class="sidebar-link">MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#å®‰è£…" class="sidebar-link">å®‰è£…</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#ä¸€-ä¸‰ä¸ªé‡è¦æ¦‚å¿µ" class="sidebar-link">ä¸€.ä¸‰ä¸ªé‡è¦æ¦‚å¿µ</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#äºŒ-åŸºæœ¬æŒ‡ä»¤" class="sidebar-link">äºŒ.åŸºæœ¬æŒ‡ä»¤</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#crud-æ“ä½œ" class="sidebar-link">CRUD æ“ä½œ</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#å°çŸ¥è¯†ç‚¹1" class="sidebar-link">å°çŸ¥è¯†ç‚¹1</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#å°çŸ¥è¯†ç‚¹2" class="sidebar-link">å°çŸ¥è¯†ç‚¹2</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#æ–‡æ¡£ä¹‹é—´çš„å…³ç³»" class="sidebar-link">æ–‡æ¡£ä¹‹é—´çš„å…³ç³»</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#å°çŸ¥è¯†ç‚¹3" class="sidebar-link">å°çŸ¥è¯†ç‚¹3</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#sortå’ŒæŠ•å½±" class="sidebar-link">sortå’ŒæŠ•å½±</a></li></ul></li><li><a href="/notes/MongoDB.html#mongoose" class="sidebar-link">Mongoose</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#ä½¿ç”¨" class="sidebar-link">ä½¿ç”¨</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#schema" class="sidebar-link">Schema</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#model" class="sidebar-link">Model</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#document" class="sidebar-link">Document</a></li><li class="sidebar-sub-header"><a href="/notes/MongoDB.html#mongoose-çš„æ¨¡å—åŒ–" class="sidebar-link">Mongoose çš„æ¨¡å—åŒ–</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mongodb-å­¦ä¹ ç¬”è®°"><a href="#mongodb-å­¦ä¹ ç¬”è®°" class="header-anchor">#</a> MongoDB å­¦ä¹ ç¬”è®°</h1> <p>ä¸€ç§æ–‡æ¡£å‹çš„ <strong>NoSQL</strong> æ•°æ®åº“</p> <p>æ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½<strong>æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„</strong>ã€‚æ”¯æŒéƒ¨åˆ†SQLè¯­å¥</p> <ul><li><p>mongoDB å°†æ•°æ®å­˜å‚¨ä¸ºä¸€ä¸ªæ–‡æ¡£ï¼Œæ•°æ®ç»“æ„ç”±é”®å€¼(key=&gt;value)å¯¹ç»„æˆã€‚å­˜å‚¨åœ¨<strong>BSON</strong>ï¼ˆbinary  json ï¼‰ã€‚å­—æ®µå€¼å¯ä»¥åŒ…å«å…¶ä»–æ–‡æ¡£ï¼Œæ•°ç»„åŠæ–‡æ¡£æ•°ç»„ã€‚</p></li> <li><p>ä¸º å¿«é€Ÿå¼€å‘Web åº”ç”¨è€Œè®¾è®¡</p></li> <li><p>æç®€ï¼Œçµæ´»</p></li> <li><p>æ•°æ®æ¨¡å‹æ˜¯é¢å‘æ–‡æ¡£çš„ï¼Œ</p></li></ul> <h2 id="mongodb"><a href="#mongodb" class="header-anchor">#</a> MongoDB</h2> <h3 id="å®‰è£…"><a href="#å®‰è£…" class="header-anchor">#</a> å®‰è£…</h3> <h4 id="windowsä¸‹çš„å®‰è£…"><a href="#windowsä¸‹çš„å®‰è£…" class="header-anchor">#</a> windowsä¸‹çš„å®‰è£…</h4> <p>ä¸‹è½½ï¼Œå®‰è£…   https://www.mongodb.com/try/download/community</p> <h4 id="linuxä¸‹å®‰è£…"><a href="#linuxä¸‹å®‰è£…" class="header-anchor">#</a> linuxä¸‹å®‰è£…</h4> <ul><li><p>ä¸‹è½½tgzæ–‡ä»¶</p></li> <li><p>é€šè¿‡scp æŒ‡ä»¤ä¸Šä¼ åˆ°æœåŠ¡å™¨</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">scp</span>  xxx.tgz admin@121.41.225.12:/usr/local/MongoDB
</code></pre></div></li> <li><p>è§£å‹</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">tar</span> -zxvf xxx.tgz -C /usr/local/MongoDB
</code></pre></div></li> <li><p>åˆ›å»ºæ–‡ä»¶å¤¹</p> <p>åˆ›å»ºdbæ–‡ä»¶å¤¹ å­˜æ”¾æ•°æ®åº“æ•°æ®ï¼Œ</p> <p>åˆ›å»ºlogæ–‡ä»¶å¤¹ï¼Œå­˜æ”¾è¾“å‡ºæ—¥å¿—</p></li> <li><p>åˆ›å»ºé…ç½®æ–‡ä»¶</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># ç«¯å£</span>
<span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">27017</span>
<span class="token comment">#æ•°æ®ç›®å½•</span>
dbpath <span class="token operator">=</span> /usr/local/MongoDB/data/db
<span class="token comment">#æ—¥å¿—æ–‡ä»¶</span>
logpath <span class="token operator">=</span> /usr/local/MongoDB/data/log/mongodb.log
<span class="token comment">#è®¾ç½®åå°è¿è¡Œ</span>
fork <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token comment">#æ—¥å¿—è¾“å‡ºæ–¹å¼</span>
logappend <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre></div></li> <li><p>åº”ç”¨é…ç½®å¹¶è¿›å…¥æ•°æ®åº“</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># binç›®å½•ä¸‹</span>
<span class="token function">sudo</span> ./mongod --config ./mongodb.conf
./mongo è¿›å…¥æ•°æ®åº“å‰å°å‘½ä»¤è¡Œ
mongo --username admin --password <span class="token number">15823413506</span>  <span class="token comment">#æœ‰ç”¨æˆ·éªŒè¯çš„æƒ…å†µä¸‹è¿æ¥æ•°æ®åº“</span>
<span class="token comment">#--config ç¼©å†™æˆ-f</span>
</code></pre></div></li> <li><p>é…ç½®$PATHï¼ˆæ¨èï¼Œéå¿…é¡»ï¼‰</p> <p>å°†binä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ æ·»åŠ åˆ° PATH ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨<strong>ä»»æ„ç›®å½•ä¸‹ ä½¿ç”¨</strong>bin/ä¸‹çš„å‘½ä»¤</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/mongodb4/bin:<span class="token environment constant">$PATH</span>
</code></pre></div><p>è¿™ä¸ªæ–¹æ³•é‡å¯å$PATH çš„è®¾ç½®å°±å¤±æ•ˆäº†ï¼Œ</p> <p>è¿˜æœ‰ç§æ°¸ä¹…çš„æ–¹æ³•å°±æ˜¯  <strong>æŠŠbinä¸‹çš„ å¯æ‰§è¡Œæ–‡ä»¶ å¤åˆ¶åˆ° /user/local/bin æˆ–è€…å…¶ä»– $PATH ä¸‹çš„ç›®å½•</strong></p></li> <li><p>è®¾ç½®ä¸€ä¸ªè´¦æˆ·ï¼Œæˆæƒä½¿ç”¨æ•°æ®åº“ï¼Œæ›´åŠ å®‰å…¨ï¼ˆæœ€å¥½è®¾ç½®ï¼Œä¸æ˜¯å¿…é¡»çš„æ­¥éª¤ï¼‰</p> <div class="language-shell extra-class"><pre class="language-shell"><code>use admin <span class="token comment">#åˆ‡æ¢åˆ°admin</span>

db.createUser<span class="token punctuation">(</span><span class="token punctuation">{</span>user:<span class="token string">&quot;admin&quot;</span>,pwd:<span class="token string">&quot;158...&quot;</span>,roles:<span class="token punctuation">[</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
db.auth<span class="token punctuation">(</span><span class="token string">'root'</span>,<span class="token string">'123456'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># ä½¿ç”¨ è´¦æˆ·ç™»å½•</span>
db.shutdownServer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#å…³é—­</span>
</code></pre></div><p>conf é…ç½®æ–‡ä»¶æ–°å¢  ä»¥ä¸‹å­—æ®µ</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#å¼€å¯èº«ä»½éªŒè¯</span>
auth <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre></div><p>éªŒè¯è´¦æˆ·çš„æ–¹å¼è¿›å…¥æ•°æ®åº“</p> <div class="language-shell extra-class"><pre class="language-shell"><code>mongo <span class="token number">127.0</span>.0.1:27017/admin --username <span class="token string">&quot;root&quot;</span> --password <span class="token string">&quot;123456&quot;</span>
</code></pre></div></li> <li><p>å¯èƒ½é‡åˆ°çš„é—®é¢˜</p> <ul><li><p>å…³é—­mongod æ–¹æ³•ï¼š</p> <div class="language-shell extra-class"><pre class="language-shell"><code>use admin
db.shutdownServer<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>mongodè‡ªå¸¦çš„é—®é¢˜ä¿®å¤å·¥å…·</p> <div class="language-shell extra-class"><pre class="language-shell"><code>mongod --repair
</code></pre></div></li></ul></li></ul> <p>éæ­£å¸¸å…³é—­mongdb ä¼šåœ¨dbæ–‡ä»¶ä¸‹ç”Ÿæˆ <strong>mongod.lock</strong>æ–‡ä»¶ï¼Œå¿…é¡»åˆ é™¤è¿™ä¸ª æ–‡ä»¶ï¼Œå¦åˆ™åé¢å¯åŠ¨ä¼šæŠ¥é”™</p> <ul><li><p><strong>å¦‚æœè¦ä½¿ç”¨navicat ç­‰æ•°æ®åº“ç®¡ç†å·¥å…·è¿œç¨‹</strong> è¿æ¥linuxçš„mongodb è¦åœ¨conf é…ç½®æ–‡ä»¶ æ·»åŠ ä»¥ä¸‹</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">bind_ip</span><span class="token operator">=</span> <span class="token number">0.0</span>.0.0 
<span class="token comment">#å› ä¸ºbind_ip é»˜è®¤ æ˜¯127.0.0.1ï¼Œåªå…è®¸æœ¬åœ°IPè¿æ¥mongodbæ•°æ®åº“ï¼Œæ”¹æˆ0.0.0.0 å…è®¸ä»»ä½•ip è¿æ¥</span>
</code></pre></div></li></ul> <h4 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="header-anchor">#</a> æ•°æ®åº“</h4> <ul><li><p>æœåŠ¡å™¨</p> <ul><li><p>ä¿å­˜æ•°æ®</p></li> <li><p><strong>mongod</strong>  å‘½ä»¤å¯åŠ¨æœåŠ¡å™¨</p> <p>å‘½ä»¤è¡Œ   mongod</p> <div class="language-shell extra-class"><pre class="language-shell"><code>mongod --dbpath D:<span class="token punctuation">\</span><span class="token punctuation">..</span>.  --port <span class="token number">129</span><span class="token comment"># å°†Dç›˜æŸç›®å½•è®¾ç½®ä¸ºæ•°æ®åº“ç›®å½•   æŒ‡å®š129ä¸ºæ•°æ®åº“ç«¯å£</span>
</code></pre></div><p>mongoDBé»˜è®¤ åœ¨ <strong>27017ç«¯å£</strong></p></li></ul></li> <li><p>å®¢æˆ·ç«¯</p> <ul><li>ç”¨æ¥æ“ä½œæ•°æ®åº“</li> <li><strong>mongo</strong> å¯åŠ¨å®¢æˆ·ç«¯</li></ul></li></ul> <p>ï¼Œ è¿›å…¥ä¸€ä¸ª mongo shell  ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªES shell æ”¯æŒ  jsä»£ç </p> <h3 id="ä¸€-ä¸‰ä¸ªé‡è¦æ¦‚å¿µ"><a href="#ä¸€-ä¸‰ä¸ªé‡è¦æ¦‚å¿µ" class="header-anchor">#</a> ä¸€.ä¸‰ä¸ªé‡è¦æ¦‚å¿µ</h3> <img src="https://cdn.jsdelivr.net/gh/Galileo01/imgCloud@master/image-20200804154707582.png" alt="image-20200804154707582" style="zoom:67%;"> <ul><li><p>mongoDB ä¸­ æ•°æ®åº“å’Œé›†åˆ  <strong>ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»º</strong></p> <p><strong>åˆ›å»ºæ–‡æ¡£æ—¶</strong>ï¼Œæ–‡æ¡£æ‰€åœ¨é›†åˆ/æ•°æ®åº“ä¸å­˜åœ¨ï¼Œ<strong>ä¼šè‡ªåŠ¨åˆ›å»º</strong></p></li></ul> <h3 id="äºŒ-åŸºæœ¬æŒ‡ä»¤"><a href="#äºŒ-åŸºæœ¬æŒ‡ä»¤" class="header-anchor">#</a> äºŒ.åŸºæœ¬æŒ‡ä»¤</h3> <ul><li><p>show dbs/show databases</p> <p>åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“</p></li> <li><p>use databaseName</p> <p>åˆ‡æ¢åˆ°å…·ä½“æ•°æ®åº“</p></li> <li><p>db</p> <p>æ˜¾ç¤ºå½“å‰æ‰€åœ¨æ•°æ®åº“å</p></li> <li><p>show collections</p> <p>åˆ—å‡ºå½“å‰æ•°æ®åº“æ‰€æœ‰é›†åˆ</p></li></ul> <h3 id="crud-æ“ä½œ"><a href="#crud-æ“ä½œ" class="header-anchor">#</a> CRUD æ“ä½œ</h3> <h5 id="_1-æ’å…¥ï¼Œå¢åŠ -æ–‡æ¡£"><a href="#_1-æ’å…¥ï¼Œå¢åŠ -æ–‡æ¡£" class="header-anchor">#</a> 1.æ’å…¥ï¼Œå¢åŠ  æ–‡æ¡£</h5> <ul><li><p>db.<collectionName>.insert(doc)   å‘é›†åˆæ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£</collectionName></p></li> <li><p>db.<collectionName>.insertOne(doc)  å•ä¸ª</collectionName></p></li> <li><p>db.<collectionName>.insertMany(doc)    æ’å…¥å¤šä¸ªæ–‡æ¡£ï¼Œå¿…é¡»ä¼ å…¥æ•°ç»„</collectionName></p></li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>db.stus.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>name:<span class="token string">&quot;sunwukong&quot;</span>,age:19<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">## æ­¤æ—¶ä¼šåˆ›å»ºtest æ•°æ®åº“ï¼Œstus é›†åˆ</span>
db.stus.insert<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>name:<span class="token string">&quot;sunwukong&quot;</span>,age:19<span class="token punctuation">}</span>,<span class="token punctuation">{</span>name:<span class="token string">&quot;zhubajie&quot;</span>,age:19<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
db.stus.find<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">## åˆ—å‡ºé›†åˆ å†…çš„æ–‡æ¡£</span>
</code></pre></div><p>å½“å‘é›†åˆæ’å…¥æ–‡æ¡£æ—¶æ²¡æœ‰æŒ‡å®š_id å±æ€§ï¼Œä¼šè‡ªåŠ¨æ·»åŠ  _ id å±æ€§ï¼Œä½œä¸º<strong>å”¯ä¸€æ ‡è¯†</strong></p> <p>è‡ªå·±æŒ‡å®šå¿…é¡»ç¡®ä¿å”¯ä¸€æ€§ï¼Œ</p> <div class="language- extra-class"><pre><code>ä½¿ç”¨ å¯åœ¨shell  ç”¨ ObjectId() å‘½ä»¤ ç”Ÿæˆ
</code></pre></div><h5 id="_2-æŸ¥è¯¢"><a href="#_2-æŸ¥è¯¢" class="header-anchor">#</a> 2.  æŸ¥è¯¢</h5> <p>æ›´å¤šæŸ¥è¯¢æ–¹å¼è§å®˜æ–¹ <a href="https://docs.mongodb.com/manual/tutorial/query-documents/" target="_blank" rel="noopener noreferrer">æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li><p>db.stus.find({<key>ï¼š<value>})   è¿”å›ä¸€ä¸ªæ•°ç»„   <strong>å¯ä»¥ç´¢å¼•å–å€¼ [0]</strong></value></key></p> <p>æŸ¥è¯¢<strong>æ‰€æœ‰</strong>ç¬¦åˆæ¡ä»¶çš„ æ–‡æ¡£ï¼Œ<strong>ä¸ä¼ å‚æ•° è¿”å›é›†åˆä¸‹çš„æ‰€æœ‰æ–‡æ¡£</strong></p> <ul><li>find().count()/length() è¿”å›ç¬¦åˆæ¡ä»¶çš„ä¸ªæ•°</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>db.stus.find<span class="token punctuation">(</span><span class="token punctuation">{</span>age:19<span class="token punctuation">}</span><span class="token punctuation">)</span>  
db.stus.find<span class="token punctuation">(</span><span class="token punctuation">{</span>obj:<span class="token punctuation">{</span>type:<span class="token string">&quot;test&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">#å¤šå±‚åµŒå¥—</span>
db.stus.find<span class="token punctuation">(</span><span class="token punctuation">{</span>age:19<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
db.stus.find<span class="token punctuation">(</span><span class="token punctuation">{</span>age:19<span class="token punctuation">}</span><span class="token punctuation">)</span>.count<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p><strong>æŸ¥è¯¢åµŒå¥—çš„åŸŸ</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">&quot;obj.type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;test&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span> <span class="token comment">#æŸ¥è¯¢ obj å­—æ®µä¸‹ï¼Œtype å­—æ®µä¸º&quot;test&quot;çš„</span>
</code></pre></div></li></ul></li> <li><p>db.stus,findOne({})    è¿”å›ä¸€ä¸ª<strong>æ–‡æ¡£å¯¹è±¡</strong></p> <p>æŸ¥è¯¢ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£å¯¹è±¡</p> <div class="language-shell extra-class"><pre class="language-shell"><code>db.stus.findOne<span class="token punctuation">(</span><span class="token punctuation">{</span>age:20<span class="token punctuation">}</span><span class="token punctuation">)</span>.age
</code></pre></div><h5 id="ä½¿ç”¨-query-operator-æŸ¥è¯¢æ“ä½œç¬¦ï¼ˆsqlæ•°æ®åº“ä¸­çš„where-ï¼‰"><a href="#ä½¿ç”¨-query-operator-æŸ¥è¯¢æ“ä½œç¬¦ï¼ˆsqlæ•°æ®åº“ä¸­çš„where-ï¼‰" class="header-anchor">#</a> ä½¿ç”¨ Query Operator æŸ¥è¯¢æ“ä½œç¬¦ï¼ˆSQLæ•°æ®åº“ä¸­çš„where ï¼‰</h5></li></ul> <table><thead><tr><th>ç­‰äº</th> <th>{<key>:<value>}</value></key></th> <th>db.col.find({&quot;by&quot;:&quot;èœé¸Ÿæ•™ç¨‹&quot;})</th></tr></thead> <tbody><tr><td>å°äº</td> <td><code>{&lt;key&gt;:{$lt:&lt;value&gt;}}</code></td> <td><code>db.col.find({&quot;likes&quot;:{$lt:50}})</code></td></tr> <tr><td>å°äºæˆ–ç­‰äº</td> <td><code>{&lt;key&gt;:{$lte:&lt;value&gt;}}</code></td> <td>db.col.find({&quot;likes&quot;:{$lte:50}})</td></tr> <tr><td>å¤§äº</td> <td><code>{&lt;key&gt;:{$gt:&lt;value&gt;}}</code></td> <td><code>db.col.find({&quot;likes&quot;:{$gt:50}})</code></td></tr> <tr><td>å¤§äºæˆ–ç­‰äº</td> <td><code>{&lt;key&gt;:{$gte:&lt;value&gt;}}</code></td> <td><code>db.col.find({&quot;likes&quot;:{$gte:50}})</code></td></tr> <tr><td>ä¸ç­‰äº</td> <td><code>{&lt;key&gt;:{$ne:&lt;value&gt;}}</code></td> <td><code>db.col.find({&quot;likes&quot;:{$ne:50}})</code></td></tr></tbody></table> <p>find().pretty()  ä½¿å¾—æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®åœ¨å‘½ä»¤è¡Œä¸­æ›´åŠ ç¾è§‚çš„æ˜¾ç¤º</p> <p>åŒæ—¶ä½¿ç”¨å¤šä¸ªæ“ä½œç¬¦</p> <div class="language-shell extra-class"><pre class="language-shell"><code>db.stus.find<span class="token punctuation">(</span><span class="token punctuation">{</span>age:<span class="token punctuation">{</span><span class="token variable">$gt</span>:19,<span class="token variable">$lt</span>:21<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼"><a href="#æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼" class="header-anchor">#</a> æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼</h5> <div class="language-shell extra-class"><pre class="language-shell"><code>db.col.find<span class="token punctuation">(</span><span class="token punctuation">{</span>title:/æ•™/<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># æŸ¥è¯¢ title å­—æ®µä»¥&quot;æ•™&quot;å­—å¼€å¤´çš„æ–‡æ¡£ï¼š</span>

db.col.find<span class="token punctuation">(</span><span class="token punctuation">{</span>title:/^æ•™/<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># æŸ¥è¯¢ titl eå­—æ®µä»¥&quot;æ•™&quot;å­—ç»“å°¾çš„æ–‡æ¡£ï¼š</span>

<span class="token comment">#db.col.find({title:/æ•™$/})</span>
</code></pre></div><ul><li><p>æŸ¥è¯¢æ•°ç»„</p> <p>ä½¿ç”¨æ“ä½œç¬¦</p> <p>{ <array field="">: { <operator1>: <value1>, ... } }</value1></operator1></array></p> <div class="language-shell extra-class"><pre class="language-shell"><code>db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> tags: <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span> <span class="token comment">#æŸ¥è¯¢åªåŒ…å«â€œredâ€â€œblankâ€ çš„tags æ•°ç»„,ä¸”é¡ºåºå›ºå®š</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> tags: <span class="token punctuation">{</span> <span class="token variable">$all</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span>, <span class="token string">&quot;blank&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span> <span class="token comment">#æŸ¥è¯¢ åŒ…å«redï¼Œblank çš„ï¼Œé¡ºåºä¸å®š</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> tags: <span class="token string">&quot;red&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span> <span class="token comment">#å¯¹äºtags æ˜¯ä¸€ä¸ªæ•°ç»„æ¥è¯´ï¼ŒæŸ¥è¯¢åŒ…å« redçš„</span>
db.inventory.find<span class="token punctuation">(</span> <span class="token punctuation">{</span> numbers: <span class="token punctuation">{</span> <span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">25</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>  <span class="token comment">#æŸ¥è¯¢ åŒ…å«å¤§äº25 æ•°å­—çš„numbers æ‰€åœ¨æ–‡æ¡£</span>
</code></pre></div></li></ul> <h5 id="_3-ä¿®æ”¹"><a href="#_3-ä¿®æ”¹" class="header-anchor">#</a> 3. ä¿®æ”¹</h5> <ul><li><p>db.collection.<strong>update</strong>(<filter>,<update> ,<options> )</options></update></filter></p> <p>é»˜è®¤ä¼šä½¿ç”¨æ–°å¯¹è±¡<update><strong>æ›¿æ¢</strong>æ—§å¯¹è±¡ï¼Œä½¿ç”¨æ“ä½œç¬¦$setå¯è§£å†³</update></p> <p><strong><update> å½¢å¼:</update></strong></p> <div class="language-js extra-class"><pre class="language-js"><code></code></pre></div></li></ul> <p>{
<update operator="">: { <field1>: <value1>, ... },
<update operator="">: { <field2>: <value2>, ... },
}</value2></field2></update></value1></field1></update></p> <div class="language- extra-class"><pre class="language-text"><code>

**é»˜è®¤ åªæ›´æ–°ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ–‡æ¡£**ï¼Œè¡Œä¸ºå’ŒupdateOne ä¸€è‡´

æ›´æ–°å¤šä¸ªæ–‡æ¡£éœ€è¦ä¼ å…¥**options**å‚æ•°

```shell
db.stus.update({age:19},{$set:{height:500}},{multi:true}) # multi è¡¨ç¤º ä¿®æ”¹å¤šä¸ªæ–‡æ¡£
</code></pre></div><ul><li><p>db.collection.updateOne(<filter>,<update> ,<options> )</options></update></filter></p></li> <li><p>db.collection.updateMany(<filter>,<update> ,<options>  )</options></update></filter></p></li> <li><p>db.collection.replaceOne(<filter>,<update> ,<options>  ) æ›¿æ¢</options></update></filter></p></li> <li><p><a href="https://docs.mongodb.com/manual/reference/operator/update" target="_blank" rel="noopener noreferrer">ä¿®æ”¹æ“ä½œç¬¦ï¼ˆ update operatorsï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>å¸¸ç”¨</p> <ul><li><p>$set</p> <p>åªè®¾ç½® å¯¹åº”çš„å±æ€§</p> <p>æ–‡æ¡£æ²¡æœ‰çš„å±æ€§å°±æ–°å»º</p></li> <li><p>$unset</p> <p>ç§»é™¤æŸä¸ªå±æ€§</p> <div class="language-shell extra-class"><pre class="language-shell"><code>db.inventory.updateOne<span class="token punctuation">(</span>
   <span class="token punctuation">{</span> item: <span class="token string">&quot;paper&quot;</span> <span class="token punctuation">}</span>,
   <span class="token punctuation">{</span>
     <span class="token variable">$set</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;size.uom&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;cm&quot;</span>, status: <span class="token string">&quot;P&quot;</span> <span class="token punctuation">}</span>,<span class="token comment">#æ›´æ–° size.uomï¼Œ status</span>
     <span class="token variable">$unset</span>:<span class="token punctuation">{</span>adress:<span class="token string">&quot;&quot;</span><span class="token punctuation">}</span>,  <span class="token comment">#ç§»é™¤address å±æ€§</span>
     <span class="token variable">$currentDate</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> lastModified: <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token comment"># å½“å‰æ—¶é—´</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>$inc</p> <p>è‡ªå¢æ“ä½œç¬¦</p></li></ul> <p>æ•°ç»„æ›´æ–°æ“ä½œç¬¦</p> <div class="language- extra-class"><pre><code> - $push

   æ•°ç»„æœ«å°¾è¿½åŠ å…ƒç´ 
</code></pre></div><ul><li><p>$addToSet</p> <p>è¿½åŠ ï¼ŒåŒæ—¶ä¿è¯<strong>å…ƒç´ ä¸é‡å¤</strong></p></li></ul></li></ul> <h5 id="_4-åˆ é™¤æ–‡æ¡£"><a href="#_4-åˆ é™¤æ–‡æ¡£" class="header-anchor">#</a> 4.åˆ é™¤æ–‡æ¡£</h5> <ul><li><p>db.collection.remove(<filter> ,<options>)</options></filter></p> <p>åˆ é™¤æ‰€æœ‰ ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£ï¼Œ</p> <p>åªåˆ é™¤ä¸€ä¸ªä½¿ç”¨deleteOneæˆ–è€… ä¼ å…¥optionså‚æ•°   true /{justOneï¼štrue}</p> <div class="language-shell extra-class"><pre class="language-shell"><code>db.collection.remove<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># åˆ é™¤æ‰€æœ‰æ–‡æ¡£ï¼Œæ¸…ç©ºé›†åˆï¼Œä½†æ€§èƒ½è¾ƒå·® ä¸æ¨è</span>
do.collection.drop<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#åˆ é™¤é›†åˆ ï¼Œæ¨è</span>
</code></pre></div></li> <li><p>db.collection.deleteOne()</p></li> <li><p>db.collection.deleteMany()</p></li> <li><p>db.dropDatabase() åˆ é™¤æ•°æ®åº“</p></li></ul> <h3 id="å°çŸ¥è¯†ç‚¹1"><a href="#å°çŸ¥è¯†ç‚¹1" class="header-anchor">#</a> å°çŸ¥è¯†ç‚¹1</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># çš„å±æ€§å€¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼ˆä¸JSONä¸€è‡´ï¼‰</span>
<span class="token comment"># è¿™ç§æ–‡æ¡£å†…éƒ¨çš„æ–‡æ¡£å«å†…åµŒæ–‡æ¡£</span>
db.users.update<span class="token punctuation">(</span><span class="token punctuation">{</span>username:<span class="token string">&quot;sunwukong&quot;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$set</span>:<span class="token punctuation">{</span>hobby:<span class="token punctuation">{</span>cities:  <span class="token punctuation">[</span><span class="token string">&quot;beijing&quot;</span>,<span class="token string">&quot;shanghai&quot;</span>,<span class="token string">&quot;shenzhen&quot;</span><span class="token punctuation">]</span> , movies:<span class="token punctuation">[</span><span class="token string">&quot;sanguo&quot;</span>,<span class="token string">&quot;hero&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># å¦‚æœè¦é€šè¿‡å†…åµŒæ–‡æ¡£æ¥å¯¹æ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢ï¼Œæ­¤æ—¶å±æ€§å   å¿…é¡»ä½¿ç”¨å¼•å· </span>
db.users.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'hobby.movies'</span><span class="token builtin class-name">:</span><span class="token string">&quot;hero&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment"># è¡¨ç¤º æŸ¥è¯¢hobby.movies æ•°ç»„åŒ…å«&quot;hero&quot; çš„æ–‡æ¡£</span>

<span class="token comment"># å‘tangsengä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„ç”µå½±Interstellar</span>
db.users.update<span class="token punctuation">(</span><span class="token punctuation">{</span>username:<span class="token string">&quot;tangseng&quot;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$push</span>:<span class="token punctuation">{</span><span class="token string">&quot;hobby.movies&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Interstellar&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
db.users.update<span class="token punctuation">(</span><span class="token punctuation">{</span>username:<span class="token string">&quot;tangseng&quot;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$addToSet</span>:<span class="token punctuation">{</span><span class="token string">&quot;hobby.movies&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Interstellar&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># Set å…ƒç´ ä¸é‡å¤</span>

<span class="token comment"># $each ä¸€æ¬¡æ·»åŠ å¤šä¸ª</span>
db.users.update<span class="token punctuation">(</span><span class="token punctuation">{</span>name:<span class="token string">&quot;xiaoming&quot;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$push</span>:<span class="token punctuation">{</span><span class="token string">&quot;hobby.movies&quot;</span>:<span class="token punctuation">{</span><span class="token variable">$each</span>:<span class="token punctuation">[</span><span class="token string">&quot;11&quot;</span>,<span class="token string">&quot;12&quot;</span>,<span class="token string">&quot;13&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment"># //17.å‘numbersä¸­æ’å…¥20000æ¡æ•°æ® 7.2s</span>
for<span class="token punctuation">(</span>let  <span class="token assign-left variable">i</span><span class="token operator">==</span> <span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">20000</span> <span class="token punctuation">;</span> i++<span class="token punctuation">)</span><span class="token punctuation">{</span>
    db.numbers.insert<span class="token punctuation">(</span><span class="token punctuation">{</span>num:i<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#æ‰§è¡Œäº†20000 æ¬¡</span>
<span class="token punctuation">}</span>
<span class="token comment"># åªè°ƒç”¨ä¸€æ¬¡</span>
<span class="token builtin class-name">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

for<span class="token punctuation">(</span>let <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token operator">=</span><span class="token number">20000</span> <span class="token punctuation">;</span> i++<span class="token punctuation">)</span><span class="token punctuation">{</span>
    arr.push<span class="token punctuation">(</span><span class="token punctuation">{</span>num:i<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

db.numbers.insert<span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å°çŸ¥è¯†ç‚¹2"><a href="#å°çŸ¥è¯†ç‚¹2" class="header-anchor">#</a> å°çŸ¥è¯†ç‚¹2</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># å‰åæ¡æ–‡æ¡£</span>
<span class="token comment"># limit(limit) </span>
db.numbers.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.limit<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment">#å¸¸ç”¨äº  åˆ†é¡µ</span>
<span class="token comment"># 11-20æ¡</span>
<span class="token comment"># skip(&lt;offset&gt;) è·³è¿‡offset çš„æ•°æ®</span>
<span class="token comment"># skip((pagenum-1)*pagesize).limit(pagesize) </span>
db.numbers.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.skip<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>.limit<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># skip å’Œlimit ç›¸å¯¹ä½ç½®äº¤æ¢ï¼Œç»“æœä¸€è‡´ï¼Œ</span>

const <span class="token assign-left variable">num</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> db.numbers.find<span class="token punctuation">(</span><span class="token punctuation">{</span>num<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># æ”¯æŒESè¯­æ³•</span>

<span class="token comment">#   æŸ¥è¯¢ sal å°äº1000  æˆ–è€… sal å¤§äº2500     $or æ“ä½œç¬¦</span>
db.emp.find<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token variable">$or</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        sal: <span class="token punctuation">{</span>
            <span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">1000</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>, <span class="token punctuation">{</span>
        sal: <span class="token punctuation">{</span>
            <span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">2500</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="æ–‡æ¡£ä¹‹é—´çš„å…³ç³»"><a href="#æ–‡æ¡£ä¹‹é—´çš„å…³ç³»" class="header-anchor">#</a> æ–‡æ¡£ä¹‹é—´çš„å…³ç³»</h3> <ol><li>1å¯¹1</li></ol> <ul><li>åœ¨MongoDB ä¸­ ï¼Œé€šè¿‡å†…åµŒæ–‡æ¡£ ä½“ç°</li></ul> <ol start="2"><li>1å¯¹N/Nå¯¹1</li></ol> <ul><li>å†…åµŒæ–‡æ¡£ï¼Œæ•°ç»„</li> <li>åœ¨æ–‡æ¡£å±æ€§å†…ä½¿ç”¨å…¶ä»–æ–‡æ¡£çš„_id</li></ul> <ol start="3"><li>Nå¯¹N</li></ol> <ul><li>å†…åµŒæ–‡æ¡£ï¼Œæ•°ç»„</li> <li>åœ¨æ–‡æ¡£å±æ€§å†…ä½¿ç”¨å…¶ä»–æ–‡æ¡£çš„_id æ•°ç»„</li></ul> <h3 id="å°çŸ¥è¯†ç‚¹3"><a href="#å°çŸ¥è¯†ç‚¹3" class="header-anchor">#</a> å°çŸ¥è¯†ç‚¹3</h3> <div class="language-shell extra-class"><pre class="language-shell"><code>
<span class="token comment"># $or æ“ä½œç¬¦</span>
<span class="token comment"># $or:[{},{},{}]</span>
<span class="token comment">#  æŸ¥è¯¢ sal å°äº1000  æˆ–åˆ™ sal å¤§äº2500</span>
db.emp.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token variable">$or</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span>sal:<span class="token punctuation">{</span><span class="token variable">$lt</span>:1000<span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span>sal:<span class="token punctuation">{</span><span class="token variable">$gt</span>:2500<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># æŸ¥è¯¢é”€å”®éƒ¨å‘˜å·¥</span>
var depno <span class="token operator">=</span> db.dept.findOne<span class="token punctuation">(</span><span class="token punctuation">{</span>
    dname: <span class="token string">&quot;é”€å”®éƒ¨&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>.deptno

db.emp.find<span class="token punctuation">(</span><span class="token punctuation">{</span>
    depno
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">#33.ä¸ºæ‰€æœ‰è–ªèµ„ä½äº1000çš„å‘˜å·¥å¢åŠ å·¥èµ„400å…ƒ</span>

</code></pre></div><h3 id="sortå’ŒæŠ•å½±"><a href="#sortå’ŒæŠ•å½±" class="header-anchor">#</a> sortå’ŒæŠ•å½±</h3> <p><strong>æŸ¥è¯¢æ–‡æ¡£æ—¶ï¼Œé»˜è®¤æ—¶æŒ‰ç…§_idå‡åºæ’åº</strong></p> <ul><li><p>sort( { age : -1 } ) å‡½æ•°</p> <p>æŒ‡å®šæ’åºè§„åˆ™</p> <p>1:å‡åºï¼Œ-1é™åº</p></li></ul> <div class="language- extra-class"><pre class="language-text"><code>sort( { age : -1, posts: 1 } ) # å…ˆæŒ‰ç…§ age é™åºæ’åºï¼Œage ç›¸åŒçš„æŒ‰ç…§ posts å‡åº
</code></pre></div><p>skipï¼Œlimitï¼Œsort ä¸‰è€… æ— è®ºç›¸å¯¹ä½ç½®ï¼Œæœ€åéƒ½æ˜¯ sort-&gt;skpi-&gt;limit</p> <ul><li><p>find å‡½æ•° çš„ æŠ•å½±</p> <p>fdb.collection.find(query, <strong>projection</strong>) ï¼Œå¯ä»¥ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ç”¨æ¥ è®¾ç½®ç»“æœçš„æŸäº›å­—æ®µä¸æ˜¾ç¤º</p></li></ul> <p><field>: &lt;1 or true&gt;	æ˜¾ç¤º
<field>: &lt;0 or false&gt;   ä¸æ˜¾ç¤º</field></field></p> <p><strong>_id é»˜è®¤æ˜¾ç¤ºï¼Œ</strong></p> <h2 id="mongoose"><a href="#mongoose" class="header-anchor">#</a> Mongoose</h2> <p>â€‹       mongoose æ˜¯ä¸€ä¸ªè®©æˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>Nodeæ¥æ“ä½œMongoDBçš„æ¨¡å—ã€‚</strong>
â€‹       Mongooseæ˜¯ä¸€ ä¸ª<strong>å¯¹è±¡æ–‡æ¡£æ¨¡å‹( ODM)åº“</strong>(æŠŠæ–‡æ¡£è½¬æ¢ä¸ºjs å¯¹è±¡ï¼Œæ˜“äºæ“ä½œ),å®ƒå¯¹NodeåŸç”Ÿçš„<strong>MongoDBæ¨¡å—</strong>è¿›è¡Œäº†è¿›-æ­¥çš„ä¼˜åŒ–å°è£…,å¹¶æä¾›äº†æ›´å¤šçš„åŠŸèƒ½ã€‚
â€‹      åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹,å®ƒè¢«ç”¨æ¥æŠŠç»“æ„åŒ–çš„æ¨¡å¼åº”ç”¨åˆ°ä¸€ä¸€ä¸ªMongoDBé›†åˆ,<strong>å¹¶æä¾›äº†éªŒè¯å’Œç±»å‹è½¬æ¢</strong>ç­‰å¥½å¤„</p> <ul><li><p>ä¼˜ç‚¹</p> <ul><li><p>å¯ä»¥ä¸ºæ–‡æ¡£åˆ›å»ºä¸€ä¸ª<strong>æ¨¡å¼ç»“æ„ï¼ˆSchemaï¼‰</strong>/æˆ–è€…å«åšä¸€ç§ç±»ä¼¼äºSQL æ•°æ®åº“çš„çº¦æŸ</p></li> <li><p>å¯ä»¥å¯¹æ¨¡å‹ä¸­çš„å¯¹è±¡/æ–‡æ¡£è¿›è¡Œ<strong>éªŒè¯</strong></p></li> <li><p>æ•°æ®å¯ä»¥é€šè¿‡ç±»å‹è½¬æ¢è½¬æ¢ä¸ºå¯¹è±¡æ¨¡å‹</p></li> <li><p>å¯ä»¥ä½¿ç”¨<strong>ä¸­é—´ä»¶</strong>æ¥åº”ç”¨ä¸šåŠ¡é€»è¾‘æŒ‚é’©</p></li> <li><p>æ¯”NodeåŸç”Ÿçš„MongoDBé©±åŠ¨æ›´å®¹æ˜“</p></li></ul></li> <li><p>mongooseä¸­ä¸ºæˆ‘ä»¬æä¾›äº†å‡ ä¸ªæ–°çš„å¯¹è±¡</p> <ul><li><strong>Schema</strong>(æ¨¡å¼å¯¹è±¡)</li></ul> <p>â€‹       Schemaå¯¹è±¡å®šä¹‰çº¦æŸäº†æ•°æ®åº“ä¸­çš„æ–‡æ¡£ç»“æ„</p> <ul><li><strong>Model</strong> ï¼ˆå¯¹åº”MongoDBçš„ é›†åˆ<strong>collections</strong>ï¼‰</li></ul> <p>â€‹       Modelå¯¹è±¡ä½œä¸ºé›†åˆä¸­çš„æ‰€æœ‰æ–‡æ¡£çš„è¡¨ç¤ºï¼Œ<strong>ç›¸å½“äº MongoDBæ•°æ®åº“ä¸­çš„é›†åˆcollection</strong></p> <ul><li><strong>Document</strong></li></ul> <p>â€‹      Documentè¡¨ç¤ºé›†åˆä¸­çš„å…·ä½“<strong>æ–‡æ¡£</strong>ï¼Œç›¸å½“äºé›†åˆä¸­ çš„ä¸€ä¸ª<strong>å…·ä½“çš„æ–‡æ¡£</strong></p></li></ul> <p>åˆ›å»ºé¡ºåº   ï¼š<strong>Schema</strong>- &gt;<strong>Model</strong>-&gt;<strong>Document</strong></p> <h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="header-anchor">#</a> ä½¿ç”¨</h3> <h4 id="å®‰è£…-2"><a href="#å®‰è£…-2" class="header-anchor">#</a> å®‰è£…</h4> <h4 id="å¼•å…¥"><a href="#å¼•å…¥" class="header-anchor">#</a> å¼•å…¥</h4> <h4 id="è¿æ¥"><a href="#è¿æ¥" class="header-anchor">#</a> è¿æ¥</h4> <ul><li><strong>mongoose.connect æ–¹æ³•</strong></li></ul> <p>mongoose.connect('<strong>mongodb</strong>ğŸ˜•/ip:ç«¯å£/æ•°æ®åº“å')</p> <div class="language-js extra-class"><pre class="language-js"><code>mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost:27017/test'</span>ï¼Œ<span class="token punctuation">{</span> useUnifiedTopology<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">,</span>useNewUrlParser<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//æ³¨ï¼šå¦‚æœlinux/windowsçš„mongodb è®¾ç½®äº†ç”¨æˆ·éªŒè¯ï¼Œéœ€è¦åœ¨è¿æ¥æ—¶è¾“å…¥ç”¨æˆ·åå¯†ç </span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://username:pass@127.0.0.1/crud?authSource=admin'</span><span class="token punctuation">,</span><span class="token punctuation">{</span> useUnifiedTopology<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">,</span>useNewUrlParser<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//authSource=admin å‚æ•°è§„å®š ç”¨äºéªŒè¯çš„ç”¨æˆ·æ¥è‡ª admin æ•°æ®åº“</span>
</code></pre></div><p>ç»æµ‹è¯•ï¼Œå¯ä»¥è¿æ¥è¿œç¨‹çš„ mongodb æ•°æ®åº“ï¼Œå‰ææ˜¯ ç›¸åº”çš„ç«¯å£å¼€æ”¾</p> <p>ç«¯å£å·è‹¥æ˜¯27017ï¼Œå¯çœ</p> <ul><li><p>ç›‘å¬æ•°æ®åº“è¿æ¥çŠ¶æ€</p> <p>mongoose å¯¹è±¡çš„connection å±æ€§ï¼Œå¯ä»¥ç»‘å®šäº‹ä»¶</p> <p>æ¯”å¦‚ï¼Œå¯ä»¥é€šè¿‡<strong>open</strong>å’Œ**close **äº‹ä»¶æ¥ç›‘æ§è¿æ¥ çš„æ‰“å¼€å’Œå…³é—­ã€‚</p></li> <li><p>æ–­å¼€è¿æ¥</p> <p>mongoose.disconnect() ä¸€èˆ¬ä¸ä½¿ç”¨</p></li> <li><p>æ“ä½œæ•°æ®åº“</p> <ul><li><p>åˆ›å»º <strong>æ¨¡å¼å¯¹è±¡ Schema</strong>  ,ä¿®é¥°æ–‡æ¡£ç»“æ„</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> stuSchema<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span>String<span class="token punctuation">,</span>
    age<span class="token operator">:</span>Number<span class="token punctuation">,</span>
    address<span class="token operator">:</span>String<span class="token punctuation">,</span>
    gender<span class="token operator">:</span><span class="token punctuation">{</span>
            type<span class="token operator">:</span>Number<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span><span class="token number">0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>åˆ›å»ºModel  å¯¹è±¡ï¼ˆ<em>åˆ›å»ºé›†åˆ</em>ï¼‰æˆ–è€… Document å¯¹è±¡</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//mongoose.model(modelName, schema)  </span>
<span class="token comment">//modelName =é›†åˆå  ï¼Œä¼šè¢«è½¬æ¢ä¸ºå¤æ•°</span>
<span class="token keyword">const</span> StuModel<span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'studs'</span><span class="token punctuation">,</span>stuSchema<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¿”å›ä¸€ä¸ªæ„é€ å‡½æ•°</span>
</code></pre></div></li> <li><p>æ“ä½œ</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">//åˆ›å»ºå¹¶æ’å…¥æ–‡æ¡£</span>
StuModel<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span><span class="token string">&quot;baikujing&quot;</span><span class="token punctuation">,</span>
        age<span class="token operator">:</span><span class="token string">'100'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ’å…¥æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ul> <p>mongoose æ‰€æœ‰api æ–¹æ³•éƒ½è¿”å› promise</p> <h3 id="schema"><a href="#schema" class="header-anchor">#</a> Schema</h3> <p>MongoBD æœ¬èº«å¾ˆçµæ´»ï¼Œä¸éœ€è¦è®¾è®¡ç»“æ„</p> <p>ä½†æ˜¯<strong>è¿˜æ˜¯éœ€è¦ä¸€å®šç¨‹åº¦ä¸Š</strong> çš„ å­—æ®µ<strong>çº¦æŸ</strong>ï¼Œä¿è¯ æ•°æ®æ·»åŠ çš„ æ­£ç¡®æ€§ï¼Œ</p> <p>ä½¿ç”¨<strong>Schema</strong> æ¨¡å¼ç»“æ„å¯¹è±¡ï¼Œå¯¹æ–‡æ¡£çš„å±æ€§ å­—æ®µè¿›è¡Œæè¿°ï¼Œçº¦æŸï¼Œ  è¿™æ ·mongoose è¿˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬<strong>è¿›è¡ŒéªŒè¯</strong>å’Œ<strong>ç±»å‹è½¬æ¢</strong></p> <h3 id="model"><a href="#model" class="header-anchor">#</a> Model</h3> <p>Model ç±» å¯¹åº” é›†åˆï¼Œé€šè¿‡Model æ“ä½œæ•°æ®åº“ï¼Œä¹Ÿå°±æ˜¯db.<collection>æ“ä½œæ•°æ®åº“</collection></p> <p>mongoose.model('studs',stuSchema);æ–¹æ³•è¿”å›ä¸€ä¸ª <strong>æ„é€ å‡½æ•°</strong>ï¼Œ<strong>new æ„é€ å‡ºçš„å°±æ˜¯ Document å®ä¾‹</strong></p> <p>ä»¥ä¸‹å¯ä»¥ç§°ä½œ    <strong>Model ç±»</strong>çš„ <strong>é™æ€æ–¹æ³•</strong>ï¼Œ</p> <h4 id="å¢"><a href="#å¢" class="header-anchor">#</a> å¢</h4> <ul><li><p>Model.create(doc(s),[options],[callback])</p> <ul><li><p>doc(s):   <strong>Array/Object</strong></p></li> <li><p>options: ä¼ é€’ç»™ ä¸­é—´ä»¶ **saveï¼ˆï¼‰**æ–¹æ³•çš„å‚æ•°</p></li> <li><p>callbackï¼šï¼ˆerr,doc(s)ï¼‰/(é”™è¯¯å¯¹è±¡ï¼Œæ’å…¥çš„å†…å®¹)</p></li> <li><p>return :Promise</p> <p>mongose ç»å¤§éƒ¨åˆ†æ–¹æ³• è¿”å›Promise ï¼Œå¯ä»¥ä½¿ç”¨<strong>then</strong> ï¼Œæˆ–è€… <strong>await</strong></p></li></ul></li></ul> <h4 id="æŸ¥"><a href="#æŸ¥" class="header-anchor">#</a> æŸ¥</h4> <ul><li><p>Model.find(filter ,[projection] ,[options],[callback])</p> <ul><li><p>filter :æŸ¥è¯¢æ¡ä»¶</p></li> <li><p>projection ï¼šæŠ•å½±å¯¹è±¡æˆ–å­—æ®µ**å­—ç¬¦ä¸²ï¼Œ**å†³å®šç»“æœè¦æ˜¾ç¤ºçš„å­—æ®µ</p></li> <li><p>options: æŸ¥è¯¢é€‰é¡¹ï¼Œskipï¼Œlimitï¼Œsort ç­‰</p></li> <li><p><strong>callback</strong> ï¼šï¼ˆerr,docsï¼‰ <strong>docs</strong> å§‹ç»ˆä¸ºæ•°ç»„</p> <p><strong>å›è°ƒå‡½æ•°å¿…ä¼ æˆ–è€…ä½¿ç”¨thenï¼ˆawait ï¼‰æ¥æ”¶è¿”å›æ•°æ®ï¼Œå¦åˆ™ä¸ä¼šæŸ¥è¯¢</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//projection å‚æ•°</span>
<span class="token comment">//1. ä½¿ç”¨mongodb çš„å¯¹è±¡å½¢å¼</span>

StuModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>age<span class="token operator">:</span><span class="token number">1000</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>_id<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">docs</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//2. ä½¿ç”¨å­—ç¬¦ä¸²</span>
StuModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>age<span class="token operator">:</span><span class="token number">1000</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'name age -_id'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">docs</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">// -_id  ä¸æ˜¾ç¤º_id</span>

<span class="token comment">//options æŸ¥è¯¢é€‰é¡¹ å‚æ•°</span>
StuModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'name age -_id'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>skip<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>limit<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>sort<span class="token operator">:</span><span class="token punctuation">{</span>age<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">docs</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// ä½¿ç”¨ then å¤„ç† promise</span>
StuModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>age<span class="token operator">:</span><span class="token number">1000</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">docs</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <p>})</p> <div class="language- extra-class"><pre class="language-text"><code>


</code></pre></div></li> <li><p>Model.findOne(filter ,[projection] ,[options],[callback])</p> <p>æŸ¥è¯¢ç¬¬ä¸€ä¸ªè¿”ç¥–filter çš„<strong>æ–‡æ¡£å¯¹è±¡</strong>ï¼Œ</p> <p>callbackï¼š (err,<strong>doc</strong>)   docå•ä¸ªæ–‡æ¡£å¯¹è±¡</p> <p>doc æ˜¯ <strong>Model æ„é€ æ–¹æ³• æ„é€ å‡ºçš„å®ä¾‹</strong></p></li> <li><p>Model.findByID(id,[projection] ,[options],[callback])</p> <p>callbackï¼š (err,<strong>doc</strong>)    <strong>docå•ä¸ªæ–‡æ¡£å¯¹è±¡</strong>ã€</p></li></ul> <h4 id="æ”¹"><a href="#æ”¹" class="header-anchor">#</a> æ”¹</h4> <ul><li><p>Model.update(filter ,doc,[options],[callback])</p> <ul><li><p>options:  é€‰é¡¹ï¼Œmulti ç­‰</p></li> <li><p>callback ğŸ˜¦ error, <strong>updateWriteOpResult</strong>)</p> <p><strong>updateWriteOpResult</strong>:åŸç”Ÿ mongoDB è¿”å›çš„æ“ä½œç»“æœ</p> <p><strong>å›è°ƒå‡½æ•°å¿…ä¼ æˆ–è€…ä½¿ç”¨thenï¼ˆawait ï¼‰æ¥æ”¶è¿”å›æ•°æ®ï¼Œå¦åˆ™ä¸ä¼šæ›´æ–°</strong></p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>StuModel<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'zhubajie'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>$<span class="token keyword">set</span><span class="token operator">:</span><span class="token punctuation">{</span>age<span class="token operator">:</span><span class="token number">1000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>multi<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p><strong>updateWriteOpResult</strong>ï¼š</p> <p>å±æ€§</p> <ul><li>n:åŒ¹é…åˆ°çš„ä¸ªæ•°</li> <li>nModified:æ›´æ”¹ä¸ªæ•°</li> <li>ok:æ›´æ–°æ˜¯å¦æˆåŠŸ</li></ul></li> <li><p>Model.updateMany(filter ,doc,[options],[callback])</p></li> <li><p>Model.updateOne(filter ,doc,[options],[callback])</p></li> <li><p>Model.replaceOne(filter ,doc,[options],[callback])</p></li></ul> <h4 id="åˆ "><a href="#åˆ " class="header-anchor">#</a> åˆ </h4> <ul><li><p>Model.remove(filter ,[options],[callback])</p> <ul><li><p>options</p></li> <li><p>callback</p> <p><strong>å›è°ƒå‡½æ•°å¿…ä¼ æˆ–è€…ä½¿ç”¨thenï¼ˆawait ï¼‰æ¥æ”¶è¿”å›æ•°æ®ï¼Œå¦åˆ™ä¸ä¼šæ›´æ–°</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>StuModel<span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;666&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>Model.deleteOne(filter ,[options],[callback])</p></li> <li><p>Model.deleteMany(filter ,[options],[callback])</p></li></ul> <h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="header-anchor">#</a> å…¶ä»–</h4> <ul><li><p>Model.count(filter,[callback])</p> <p>ç»Ÿè®¡ ä¸ªæ•°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç»Ÿè®¡æ‰€æœ‰ä¸ªæ•°</span>
StuModel<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>count</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
StuModel<span class="token punctuation">.</span><span class="token function">countDocuments</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>count</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <p>å°†åœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬ç§»é™¤ï¼Œæ¨èä½¿ç”¨countDocuments æ–¹æ³•ä»£æ›¿  in v 5.927</p> <h3 id="document"><a href="#document" class="header-anchor">#</a> Document</h3> <p>Document æ˜¯Model æ„é€ çš„ å®ä¾‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//åˆ›å»º Document å®ä¾‹</span>
<span class="token keyword">const</span> stu<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StuModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span><span class="token string">&quot;å°ç±³&quot;</span><span class="token punctuation">,</span>
        age<span class="token operator">:</span><span class="token number">20</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>â€‹		<strong>å®ä¾‹æ–¹æ³•</strong></p> <ul><li><p>doc.save([options],callback)</p> <p>å°†æ–‡æ¡£ä¿å­˜åˆ°é›†åˆ</p> <ul><li>callback :(err,<strong>updateWriteOpResult</strong>)</li></ul></li> <li><p>doc.update(update,[options],<strong>callback</strong>)</p> <ul><li><p>update</p></li> <li><p>callback : (err)</p> <p><strong>å›è°ƒå‡½æ•°å¿…ä¼ æˆ–è€…ä½¿ç”¨thenï¼ˆawait ï¼‰æ¥æ”¶è¿”å›æ•°æ®ï¼Œå¦åˆ™ä¸ä¼šæ›´æ–°</strong></p></li></ul></li></ul> <p>å°†è¦å¼ƒç”¨ ï¼Œæ¨è document.updateOne/updateMany ä»£æ›¿  in  v 5.927</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åˆ›å»ºä¸€ä¸ª docuemnt å¯¹è±¡</span>
<span class="token keyword">const</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StuModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span><span class="token punctuation">,</span>
        age<span class="token operator">:</span> <span class="token number">20</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">await</span> stu<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        StuModel<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">let</span> res<span class="token punctuation">;</span>
                 doc<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> $<span class="token keyword">set</span><span class="token operator">:</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">777</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// console.log(res);</span>
            
                <span class="token comment">//ç¬¬äºŒç§æ–¹æ³•</span>
                doc<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token string">&quot;æ­¦æ±‰å°ç±³&quot;</span><span class="token punctuation">;</span>
                res <span class="token operator">=</span> <span class="token keyword">await</span> doc<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// console.log(res);</span>
            <span class="token comment">//åˆ é™¤</span>
                res <span class="token operator">=</span> <span class="token keyword">await</span> doc<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// console.log(res);</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p>doc.remove([callback])</p></li> <li><p>doc.get(feild)</p></li> <li><p>doc.set(feild,value)</p></li> <li><p>doc.toJSON([options])</p> <p>è½¬æ¢ä¸ºJSONå¯¹è±¡</p> <ul><li><a href="https://mongoosejs.com/docs/api/document.html#document_Document-toObject" target="_blank" rel="noopener noreferrer">options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> é€‰é¡¹å‚æ•°</li></ul></li> <li><p>doc.toObject([options])</p></li></ul> <p>â€‹     è¿”å› <strong>js æ™®é€šå¯¹è±¡</strong>ï¼Œè¿”å›çš„å¯¹è±¡  <strong>æ²¡æœ‰Document çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•</strong></p> <p>â€‹        options å’ŒtoJSONæ–¹æ³•ä¸€è‡´</p> <ul><li><p>doc.idå±æ€§</p> <p>documents._id çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œ</p> <p>ä½¿ç”¨filter è¿›è¡ŒæŸ¥æ‰¾æ—¶ï¼Œ_idå¯ä»¥ä¼ å…¥å­—ç¬¦ä¸²ï¼Œè€Œï¼Œ<strong>document ä¹‹é—´çš„æ¯”è¾ƒ</strong>   éœ€è¦ä½¿ç”¨  .idå±æ€§ï¼Œè¿›è¡Œå­—ç¬¦ä¸²çš„æ¯”è¾ƒï¼Œå› ä¸º <strong>å¯¹è±¡å½¢å¼</strong>çš„ObjectId()æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œå§‹ç»ˆä¸ç›¸ç­‰ï¼Œ</p></li></ul> <h3 id="mongoose-çš„æ¨¡å—åŒ–"><a href="#mongoose-çš„æ¨¡å—åŒ–" class="header-anchor">#</a> Mongoose çš„æ¨¡å—åŒ–</h3> <p>æŠ½ç¦»æ¨¡å—</p> <ul><li><p>è¿æ¥æ¨¡å—</p> <p>ä¸“é—¨ç”¨äºå’Œæ•°æ®åº“è¿›è¡Œè¿æ¥</p></li> <li><p>æ¨¡å‹å¯¹è±¡æ¨¡å—</p> <p>æŠ½è±¡å‡ºä¸åŒçš„Model å¯¹è±¡ï¼Œå¹¶å¯¼å‡ºï¼Œåœ¨è·¯ç”±å†…è°ƒç”¨ï¼Œæ“ä½œæ•°æ®åº“</p></li></ul> <p>æ”¾ç½®åœ¨ä¸åŒæ–‡ä»¶å¤¹</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/27/2020, 12:37:33 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.3e4d0eed.js" defer></script><script src="/assets/js/2.68aca893.js" defer></script><script src="/assets/js/15.9c338a9c.js" defer></script>
  </body>
</html>

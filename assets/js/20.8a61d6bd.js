(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{420:function(t,s,a){"use strict";a.r(s);var n=a(27),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"node-学习笔记"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-学习笔记"}},[t._v("#")]),t._v(" Node 学习笔记")]),t._v(" "),a("h3",{attrs:{id:"一-node-js-介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-node-js-介绍"}},[t._v("#")]),t._v(" 一.Node.js 介绍")]),t._v(" "),a("p",[t._v("Node.js 是一个基于 Chrome V8 引擎的 JavaScript "),a("strong",[t._v("运行时环境")])]),t._v(" "),a("p",[t._v("事件驱动，非阻塞I/O（异步操作），轻量高效")]),t._v(" "),a("p",[t._v("提供在浏览器外解析和执行js 的能力")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("浏览器中的JavaScript")]),t._v(" "),a("ul",[a("li",[t._v("ECMAScript")]),t._v(" "),a("li",[t._v("DOM")]),t._v(" "),a("li",[t._v("BOM")])])]),t._v(" "),a("li",[a("p",[t._v("Node 中的Javascript")]),t._v(" "),a("ul",[a("li",[t._v("ECMAScript")]),t._v(" "),a("li",[t._v("一些服务器级别的操作API\n"),a("ul",[a("li",[t._v("文件读写，网络服务，数据库连接等")])])])])])]),t._v(" "),a("h3",{attrs:{id:"二-node能做什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-node能做什么"}},[t._v("#")]),t._v(" 二.Node能做什么")]),t._v(" "),a("ul",[a("li",[t._v("WEB 服务器后台")]),t._v(" "),a("li",[t._v("命令行工具\n"),a("ul",[a("li",[t._v("npm")]),t._v(" "),a("li",[t._v("hexo（基于node开发）")]),t._v(" "),a("li",[t._v("。。。")])])])]),t._v(" "),a("h3",{attrs:{id:"三-下载安装和执行js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-下载安装和执行js"}},[t._v("#")]),t._v(" 三.下载安装和执行js")]),t._v(" "),a("p",[t._v("node  helloworld.js")]),t._v(" "),a("h3",{attrs:{id:"api文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api文档"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"http://nodejs.cn/api/",target:"_blank",rel:"noopener noreferrer"}},[t._v("API文档"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"四-文件读取"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四-文件读取"}},[t._v("#")]),t._v(" 四.文件读取")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("浏览器的js没有"),a("strong",[t._v("主动读取文件")]),t._v("的权限")]),t._v(" "),a("p",[t._v("浏览器的实现方法：input:file+FileReader对象，需要用户点击表单，选择文件")])]),t._v(" "),a("li",[a("p",[t._v("fs模块：file-system   提供文件读写的API")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引入fs模块")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("读取文件")]),t._v(" "),a("p",[t._v("读取文件的方法有很多")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//异步读取")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//fs.readFile(path[, options], callback) 已回调的方式 异步读取文件 ")]),t._v("\nfs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//若未指定编码格式，data 为缓冲区Buffer内的一串二进制")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//同步读取")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("写文件")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//flag:'a'已追加的模式进行写入")]),t._v("\nfs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text write'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" flag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'文件写入成功'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"五-使用http-创建web服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五-使用http-创建web服务"}},[t._v("#")]),t._v(" 五.使用http 创建web服务")]),t._v(" "),a("p",[t._v("核心：http 模块")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2.创建 server实例")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" serve"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3.监听request 事件，执行处理函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*处理函数 的参数：\n*/")]),t._v("\nserve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'request'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(req,'接收到请求');")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//请求的路径，已 /开头")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//请求头")]),t._v("\n\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//请求方式")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/plain;charset=utf-8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//告知浏览器 用utf-8编码，解析纯文本    'text/html;charset=utf-8'):按照html 解析")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//res.write 方法给客户端发送响应 可以多次发送")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// res.write(req.url);")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// res.end();//结束响应，告知客户端停止等待")]),t._v("\n    \n\t "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//直接使用end 发送并结束请求")]),t._v("\n     res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'登录'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//4.监听端口号，启动http服务")]),t._v("\nserve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'server is running at 127.0.0.1:8000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("//node 默认返回utf-8的编码，")]),t._v(" "),a("h3",{attrs:{id:"六-node-的模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六-node-的模块"}},[t._v("#")]),t._v(" 六.Node 的模块")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("核心模块")]),t._v(" "),a("p",[t._v("服务器级别的api，fs，http，os，path")]),t._v(" "),a("p",[t._v("通过require 方法 引入加载模块")])]),t._v(" "),a("li",[a("p",[t._v("node 的模块系统    基于     "),a("strong",[t._v("CommonJs 规范")]),t._v("  实现node 自己的 模块规范")]),t._v(" "),a("p",[t._v("具名的核心模块，用户模块")])])]),t._v(" "),a("h4",{attrs:{id:"导入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导入"}},[t._v("#")]),t._v(" "),a("strong",[t._v("导入")])]),t._v(" "),a("p",[t._v("require的作用： "),a("strong",[t._v("require(id) 方法")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("加载模块并执行")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("导入模块指定的导出对象")])])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//a.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./b.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//执行b.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//后缀名可省， ./不可省略")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./b'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("h4",{attrs:{id:"导出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导出"}},[t._v("#")]),t._v(" "),a("strong",[t._v("导出")])]),t._v(" "),a("p",[t._v("在"),a("strong",[t._v("module.exports")]),t._v(" /"),a("strong",[t._v("exports")]),t._v("对象上"),a("strong",[t._v("挂载要导出的数据")])]),t._v(" "),a("p",[t._v("module.exports/exports默认为空")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//b.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//导出多个 对象")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("name\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// module.exports.f = ... 可以更简洁地写成 exports.f = ...,快捷方式")]),t._v("\nexports"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("name\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//导出单个对象  ")]),t._v("\nexports"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//错误方法 ！！！！！")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//正确")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n原因在于模块内 默认 exports= module.exports，\n对exports 赋值后 exports 失去了对 module.exports  的引用  \n最后模块导出的是  module.exports 对象*/")]),t._v("\n")])])]),a("h4",{attrs:{id:"其他知识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他知识"}},[t._v("#")]),t._v(" 其他知识")]),t._v(" "),a("ul",[a("li",[t._v("node 中，每个模块 有一个"),a("strong",[t._v("module")]),t._v(" 对象，")])]),t._v(" "),a("p",[t._v("包含id，exports，parent，filename，loaded，children以及paths几个属性。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("每个模块拥有    "),a("strong",[t._v("文件作用域，互相隔离")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("优先从缓存加载模块")])])])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Galileo01/imgCloud@master/image-20200731210206061.png",alt:"image-20200731210206061"}})]),t._v(" "),a("p",[t._v("'b.js 被加载了' 只会 输出一次")]),t._v(" "),a("p",[t._v("b.js    "),a("strong",[t._v("只会加载1次")]),t._v("，第二次 从"),a("strong",[t._v("缓存 读取")])]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("模块")]),t._v("id")]),t._v(" "),a("p",[a("strong",[t._v("require(id) 方法：")])]),t._v(" "),a("p",[t._v("参数id:"),a("string",[t._v(" 模块的   "),a("strong",[t._v("名称或路径")])])],1),t._v(" "),a("p",[t._v("名称：核心模块和"),a("strong",[t._v("npm安装的的第三方 模块名称")])]),t._v(" "),a("p",[a("em",[t._v("对于**npm安装的的第三方 模块名称：require('xxx')")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("找当前目录下node_modules/"),a("code",[t._v("xxx")]),t._v(" 目录 下的"),a("strong",[t._v("package.json")]),t._v("  文件")])]),t._v(" "),a("li",[a("p",[t._v("package.json 的"),a("strong",[t._v("main")]),t._v(" 属性指向的"),a("strong",[t._v("js文件")]),t._v(" 指向 的是 "),a("strong",[t._v("当前模块的入口文件")])])]),t._v(" "),a("li",[a("p",[t._v("加载引入这个  "),a("strong",[t._v("入口文件")]),t._v("，")]),t._v(" "),a("p",[t._v("若 main为空/package.json 不存在，默认转为加载  index.js ，index.node .....")]),t._v(" "),a("p",[t._v("若也不存在，继续"),a("strong",[t._v("向上一级文件的 node_modules 查找")]),t._v("，")]),t._v(" "),a("p",[t._v("找到盘根都没有就报错")])])]),t._v(" "),a("p",[t._v("路径： ./ ../  开头")])])]),t._v(" "),a("h3",{attrs:{id:"es6-module-模块系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#es6-module-模块系统"}},[t._v("#")]),t._v(" ES6 Module 模块系统")]),t._v(" "),a("p",[t._v("es6 官方规范了模块系统，在script标签 添加 "),a("strong",[t._v('type="module"')]),t._v(" 使用模块语法")]),t._v(" "),a("h4",{attrs:{id:"导入-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导入-2"}},[t._v("#")]),t._v(" 导入")]),t._v(" "),a("p",[t._v("通过"),a("strong",[t._v("import")]),t._v(" 关键字 导入模块")]),t._v(" "),a("p",[t._v("**只能写在js顶层 **，编译时执行")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("默认导入")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" qs "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'qs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//适用于默认导出")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("命名导入")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utils.js'")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("全部导入")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Module "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/modules/module.mjs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//* 代表所有  ，as 重命名")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//将模块内所有的可用的导出，导入到模块对象Module上，可以像使用对象一样使用：Module.xxx ，代码更简洁")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" page"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./page.vue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//作为导入函数调用，将其作为参数传递给模块的路径  适用于 页面的懒加载")]),t._v("\n")])])]),a("p",[t._v("另外 导入支持 "),a("strong",[t._v("as")]),t._v(" 关键字的重命名，用于解决命名空间的问题")]),t._v(" "),a("h4",{attrs:{id:"导出-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导出-2"}},[t._v("#")]),t._v(" 导出")]),t._v(" "),a("p",[t._v("通过"),a("strong",[t._v("export")]),t._v(" 关键字导出对象/类/变量....")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("命名导出")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//方式1：依次单个导出")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lisi"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" age"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//方式2：文件最后统一导出")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\nname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("默认导出")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'777'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用于主要数据的导出   只能允许出现一次默认导出")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在引入时 可以使用任何 名字导入")]),t._v("\n")])])]),a("p",[t._v("两者导出方法可以共存")])])]),t._v(" "),a("h3",{attrs:{id:"commonjs-和-es6-module-的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commonjs-和-es6-module-的区别"}},[t._v("#")]),t._v(" CommonJs 和 ES6 Module 的区别")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("CommonJs")]),t._v("导出的是变量的一份拷贝，"),a("code",[t._v("ES6 Module")]),t._v("导出的是变量的绑定（引用）")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("CommonJs")]),t._v("是单个值导出（exports ），"),a("code",[t._v("ES6 Module")]),t._v("可以导出多个（命名导出）")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("CommonJs")]),t._v("是动态语法可以写在判断里，"),a("code",[t._v("ES6 Module")]),a("strong",[t._v("静态语法")]),t._v("只能写"),a("strong",[t._v("在顶层")])]),t._v(" "),a("p",[t._v("ES6 模块"),a("strong",[t._v("编译时执行")]),t._v("，而CommonJS模块总是在"),a("strong",[t._v("运行时加载")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("CommonJs")]),t._v("的 "),a("code",[t._v("this")]),t._v(" 是当前模块，"),a("code",[t._v("ES6 Module")]),t._v("的 "),a("code",[t._v("this")]),t._v(" 是 "),a("code",[t._v("undefined")])])])]),t._v(" "),a("h3",{attrs:{id:"在node中使用es6-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在node中使用es6-module"}},[t._v("#")]),t._v(" 在node中使用ES6 module")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("全部使用mjs后缀名")])]),t._v(" "),a("li",[a("p",[t._v("按照ES6标准 ，书写import 和export 代码")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("运行文件时时")]),t._v("  添加 --experimental-modules 参数")]),t._v(" "),a("p",[t._v("node --experimental-modules .\\b.mjs")])])]),t._v(" "),a("h3",{attrs:{id:"七-content-type"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#七-content-type"}},[t._v("#")]),t._v(" 七.Content-Type")]),t._v(" "),a("p",[t._v("内容类型，用于定义网络传输中文件的"),a("strong",[t._v("MIME")]),t._v("类型和网页的编码，决定文件接收方将以什么形式、什么编码读取这个文件")]),t._v(" "),a("p",[t._v("常见的媒体格式类型如下：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("text/html ： HTML格式")])]),t._v(" "),a("li",[a("p",[t._v("text/plain ：纯文本格式")])]),t._v(" "),a("li",[a("p",[t._v("image/gif ：gif图片格式")])]),t._v(" "),a("li",[a("p",[t._v("image/jpeg ：jpg图片格式")])]),t._v(" "),a("li",[a("p",[t._v("image/png：png图片格式")])])]),t._v(" "),a("p",[t._v("以application开头的媒体格式类型：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("application/json  ： JSON数据格式")])]),t._v(" "),a("li",[a("p",[t._v("application/pdf    ：pdf格式")])]),t._v(" "),a("li",[a("p",[t._v("application/javascript ：js文件")])]),t._v(" "),a("li",[a("p",[t._v("application/msword ： Word文档格式")])]),t._v(" "),a("li",[a("p",[t._v("application/octet-stream ： 二进制流数据（如常见的文件下载）")])]),t._v(" "),a("li",[a("p",[t._v("application/x-www-form-urlencoded ： ")]),a("form",{attrs:{encType:""}},[t._v("中默认的encType，form表单数据被编码为key/value格式发送到服务器（表单"),a("strong",[t._v("默认的提交数据的格式")]),t._v("）"),a("p")])])]),t._v(" "),a("p",[t._v("另外一种常见的媒体格式是上传文件之时使用的：")]),t._v(" "),a("ul",[a("li",[t._v("multipart/form-data ： 需要在表单中进行"),a("strong",[t._v("文件上传时，就需要指定使用该格式")])])]),t._v(" "),a("h3",{attrs:{id:"小练习：一个静态资源api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小练习：一个静态资源api"}},[t._v("#")]),t._v(" 小练习：一个静态资源API")]),t._v(" "),a("ul",[a("li",[t._v("response.writeHead(statusCode[, statusMessage][, headers]) 方法")])]),t._v(" "),a("p",[t._v("向请求发送响应头。 状态码是一个 3 位的 HTTP 状态码，如 "),a("code",[t._v("404")]),t._v("。 最后一个参数 "),a("code",[t._v("headers")]),t._v(" 是响应头。 可以可选地将用户可读的 "),a("code",[t._v("statusMessage")]),t._v(" 作为第二个参数")]),t._v(" "),a("p",[t._v("返回对 "),a("code",[t._v("ServerResponse")]),t._v(" 的引用，以便可以链式调用")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text/html;charset=utf-8'")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<h1>404 not found</h1>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h4",{attrs:{id:"补充知识点-http模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#补充知识点-http模块"}},[t._v("#")]),t._v(" 补充知识点   http模块")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("获取GET请求的参数")]),t._v(" "),a("p",[t._v("get请求的参数是直接通过url表达的")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'url'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引入url用于解析url")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" querystring "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'querystring'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引入querystring 用于解析query字符串，分隔?和&，转化为一个参数对象")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//.....省略代码")]),t._v("\n\nserve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'request'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//解析url，构建URL对象，")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pathname"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pathname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" query "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" querystring"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//解析 query 得到路径里的每个参数,返回一个参数对象")]),t._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("获取POST请求的参数")]),t._v(" "),a("p",[t._v("POST 请求的内容全部的都在请求体中，http.ServerRequest 并没有一个属性内容为请求体，原因是等待请求体传输可能是一件耗时的工作。所以 node.js 默认是不会解析请求体的，当你需要的时候，"),a("strong",[t._v("需要手动来做。")])])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" querystring "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'querystring'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" util "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'util'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" postParams"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//字符串")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//通过req的data事件监听函数，每当接受到请求体的数据，就已数据块的方式 拼接 到post变量中")]),t._v("\n        req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            postParams"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在end事件触发后，通过querystring.parse将post解析为真正的POST请求格式")]),t._v("\n        req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            postParams"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("querystring"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("postParams"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//解析为对象")]),t._v("\n            console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("postParams"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("inspect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("postParams"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//转换为字符串")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"八-评论页面-feedback"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#八-评论页面-feedback"}},[t._v("#")]),t._v(" 八.评论页面 feedback")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("读取目录")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readdir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//files：文件名、目录数组")]),t._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("模板html 文读取之后就是字符串，可直接更改")])]),t._v(" "),a("li",[a("p",[t._v("Node 中使用html 模板引擎 ///服务器渲染")]),t._v(" "),a("p",[a("strong",[t._v("art-template 引擎")]),t._v("，提供模板语法  "+t._s(t.name)+"插值语法，类似于Vue 模板语法")]),t._v(" "),a("p",[t._v("模板引擎最开始就是诞生于服务器，后来才发展到前端")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" templateEngine "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'art-template'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//templateEngine.render('模板字符串',替换对象)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Document</title>\n</head>\n<body>\n       <p>大家好。我叫{{name}}</p>\n       <p>我今年{{age}}岁</p>\n       <p>我喜欢{{like}}</p>\n</body>\n</html>')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("templateEngine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'JACK'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    age"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'20'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    like"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'codeing'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[a("strong",[t._v("服务端渲染和客户端渲染")])])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("客户端渲染")]),t._v(" "),a("p",[t._v("客户端发起请求，服务端把页面（响应的是字符串）发送过去，客户端从上到下依次解析，如果在解析的过程中，发现ajax")]),t._v(" "),a("p",[t._v("请求，再次像服务器发送新的请求，客户端拿到ajax 响应数据，模板引擎渲染。至少两次请求")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("缺点： 对SEO相当不友好")])]),t._v(" "),a("li",[a("p",[t._v("优点： 减轻了服务器端的渲染压力;同时，最大的好处就是：能够实现前后端分离开发;")])])])]),t._v(" "),a("li",[a("p",[t._v("服务端渲染")]),t._v(" "),a("p",[t._v("服务端过程：1.读取index.html  2.模版进行渲染，在发送给客户端之前，在服务端已经把"),a("strong",[t._v("index.html 渲染处理好了")]),t._v("才发给客户端，客户端浏览器直接渲染html文件，不需要多余的请求")]),t._v(" "),a("ul",[a("li",[t._v("优点：对SEO友好，因为我们经过服务器端渲染的页面，在网络中传输的时候，传输的是一个**真实的页面。**因此，爬虫客户端，当爬到我们的页面后，")])]),t._v(" "),a("p",[t._v("会分析我们给他提供的这个页面，此时，我们页面中的关键数据就会被爬虫给收录了。")]),t._v(" "),a("ul",[a("li",[t._v("缺点： 服务器端渲染，对服务器压力比较打，可以使用服务器端的页面缓存技术，减轻服务器的渲染压力；不适合前后端分离开发。")])])])]),t._v(" "),a("p",[a("strong",[t._v("最重要的区别就是究竟是谁来完成html文件的完整拼接")])]),t._v(" "),a("p",[t._v("很多网站是两者相结合")]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("html 模板的里的 src/href 等，"),a("strong",[t._v("应该使用 url")]),t._v(" ，不该使用相对路径")])]),t._v(" "),a("p",[t._v("浏览器收到 HTML 响应内容之后，就要开始从"),a("strong",[t._v("上到下依次解析")]),t._v("，\n当在解析的过程中，如果发现：\nlink\nscript\nimg\niframe\nvideo\naudio\n等带有 s"),a("strong",[t._v("rc 或者 href（link） 属性标签（具有外链的资源）的时候，浏览器会自动对这些资源发起新的请求")]),t._v("。")]),t._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[t._v("form 标签，提交表单请求")])]),t._v(" "),a("p",[t._v("表单中需要提交的表单控件元素必须具有 name 属性,就是请求时的参数名称\n表单提交分为：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("    1. 默认的提交行为\n            2. 表单异步提交\n          **action** 指定表单提交的请求url\n            method 请求方法get/post\n            \n            enctype:规定 content——type MIME类型\n            默认：application/x-www-form-urlencoded \n            当需要上传文件时 需要改为   multipart/form-data \n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("url模块   获取GET参数  ,post 请求")])]),t._v(" "),a("li",[a("p",[t._v("重定向")]),t._v(" "),a("p",[t._v("301：永久重定向")]),t._v(" "),a("p",[t._v("302：暂时重定向")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("302")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Location'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//重定向到 / 根")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"九-package-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#九-package-json"}},[t._v("#")]),t._v(" 九.package.json")]),t._v(" "),a("ol",[a("li",[t._v("包说明文件，描述当前"),a("strong",[t._v("项目的信息")]),t._v("    通过   npm init -y  创建（-y ： yes ,省去了默认选项点击）")])]),t._v(" "),a("p",[t._v("字段：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("dependencies")]),t._v(" "),a("strong",[t._v("运行时依赖")]),t._v("/"),a("strong",[t._v("生产阶段的依赖")])])]),t._v(" "),a("p",[t._v("npm install xxx "),a("strong",[t._v("--save")]),t._v(" 会把依赖记录在 "),a("strong",[t._v("dependencies")]),t._v(" 字段下，记录当前 项目的"),a("strong",[t._v("运行时依赖")])]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("devDependencies")]),t._v(" "),a("strong",[t._v("开发时依赖")])])]),t._v(" "),a("li",[a("p",[t._v("scripts  :npm命令行指令")])]),t._v(" "),a("li",[a("p",[t._v("......")])]),t._v(" "),a("li")]),t._v(" "),a("p",[t._v("通过 "),a("strong",[t._v("npm install")]),t._v("  安装回所有依赖")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("package-lock.json 文件")]),t._v(" "),a("p",[t._v("会在npm更改node_modules目录树或者package.json时自动生成的，"),a("strong",[t._v("它准确的描述了当前项目npm包的依赖树，"),a("strong",[t._v("并且在")]),t._v("随后的安装中会根据package-lock.json来安装")]),t._v("，保证是相同的一个依赖树，速度更快")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("描述了当前项目npm包的依赖树")])]),t._v(" "),a("li",[t._v("锁定依赖版本 -lock")])])])]),t._v(" "),a("h3",{attrs:{id:"十-npm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#十-npm"}},[t._v("#")]),t._v(" 十.npm")]),t._v(" "),a("ul",[a("li",[t._v("npm网站")]),t._v(" "),a("li",[t._v("包管理工具 ,一个命令行工具")])]),t._v(" "),a("p",[t._v("npm -v 查看版本")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("常用命令")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("npm init")]),t._v(" "),a("p",[t._v("npm init -y")])]),t._v(" "),a("li",[a("p",[t._v("npm install")]),t._v(" "),a("p",[t._v("按照 "),a("strong",[t._v("dependencies")]),t._v(" "),a("strong",[t._v("devDependencies")]),t._v("    所有依赖")]),t._v(" "),a("p",[t._v("简写：npm i")])]),t._v(" "),a("li",[a("p",[t._v("npm install xxx")]),t._v(" "),a("p",[t._v("npm i xxx")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("npm install xxx --save")])]),t._v(" "),a("p",[t._v("下载并保存到package.json 文件的 "),a("strong",[t._v("dependencies")])]),t._v(" "),a("p",[t._v("npm i xxx -S")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("npm install xxx --save -dev")])]),t._v(" "),a("p",[t._v("下载并保存到package.json 文件的 "),a("strong",[t._v("devDependencies")])]),t._v(" "),a("p",[t._v("npm i xxx -D")])]),t._v(" "),a("li",[a("p",[t._v("npm uninstall  xxx")]),t._v(" "),a("p",[t._v("删除模块，但保存依赖")]),t._v(" "),a("p",[t._v("npm un xxx")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("npm uninstall xxx --save")])]),t._v(" "),a("p",[t._v("删除模块，同时删除依赖")]),t._v(" "),a("p",[a("strong",[t._v("npm un xxx -S")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("npm uninstall xxx --save -dev")])]),t._v(" "),a("p",[a("strong",[t._v("npm un xxx -D")])])]),t._v(" "),a("li",[a("p",[t._v("npm install xxx -gloabl")]),t._v(" "),a("p",[t._v("全局按照 xxx")]),t._v(" "),a("p",[t._v("npm i xxx -g")])]),t._v(" "),a("li",[a("p",[t._v("npm ls")]),t._v(" "),a("p",[t._v("查看安装的模块")])]),t._v(" "),a("li",[a("p",[t._v("npm 命令 --help")]),t._v(" "),a("p",[t._v("查看命令帮助")])]),t._v(" "),a("li",[a("p",[t._v("......")])]),t._v(" "),a("li",[a("p",[t._v("npm config")]),t._v(" "),a("p",[t._v("配置npm")])]),t._v(" "),a("li",[a("p",[t._v("npm config list")]),t._v(" "),a("p",[t._v("列出 配置")])]),t._v(" "),a("li",[a("p",[t._v("npm list --depth=0 -global")]),t._v(" "),a("p",[t._v("获取全局安装的模块")])])])]),t._v(" "),a("li",[a("p",[t._v("使用cnpm")]),t._v(" "),a("p",[t._v("使用 淘宝镜像 npm.taobao.org")]),t._v(" "),a("p",[t._v("npm i  cnpm -g    //全局按照cnpm")]),t._v(" "),a("p",[a("strong",[t._v("cnpm i xxx --save")])])])]),t._v(" "),a("h3",{attrs:{id:"十一-express"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#十一-express"}},[t._v("#")]),t._v(" 十一.Express")]),t._v(" "),a("p",[a("strong",[t._v("Web 开发框架")]),t._v("    提高开发的效率")]),t._v(" "),a("p",[a("strong",[t._v("express")]),t._v("，"),a("strong",[t._v("koa")]),t._v(" 等")]),t._v(" "),a("h4",{attrs:{id:"基本使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本使用"}},[t._v("#")]),t._v(" 基本使用")]),t._v(" "),a("ul",[a("li",[t._v("安装，起步")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建 app  ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//静态资源 服务,使用 express.static 中间件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//匹配 url中 的/resource 到 当前./resource 下的文件")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/resource'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("express"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("static")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./resource'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//匹配请求路径 === 路由")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<h1>hello</h1>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//监听端口")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'running '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[t._v("静态资源 服务")]),t._v(" "),a("p",[t._v("app.use 添加 express 自带的中间件express.static")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//匹配 url中 的/resource 到 当前./resource 下的文件")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/resource'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("express"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("static")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./resource'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//通过/resource/main.js访问")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("express"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("static")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./resource'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//通过/main.js访问 ")]),t._v("\n")])])]),a("p",[a("strong",[t._v("使用这种方法可以快速搭建静态网站")])])]),t._v(" "),a("li",[a("p",[t._v("基本请求路由 router")]),t._v(" "),a("p",[t._v("匹配请求路径，映射关系，路由表")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("app.get(’'/'')")])]),t._v(" "),a("li",[a("p",[t._v("app.post('/')")])])])]),t._v(" "),a("li",[a("p",[t._v("获取get 请求参数")]),t._v(" "),a("p",[t._v("req."),a("strong",[t._v("query")]),t._v("  一个处理好的参数对象")])]),t._v(" "),a("li",[a("p",[t._v("获取post 请求参数")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("使用"),a("strong",[t._v("express")]),t._v(" 自带的"),a("strong",[t._v("中间件")]),t._v(" 解析post 参数")]),t._v(" "),a("p",[t._v("使用以下中间件，填充"),a("strong",[t._v("req.body")]),t._v(" (req.body 默认为空)")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("express"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// for parsing application/json")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("express"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("urlencoded")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" extended"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// for parsing application/x-www-form-urlencoded")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("第三方中间件 "),a("strong",[t._v("body-parser")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code")])])])]),t._v(" "),a("p",[t._v("var bodyParser = require('body-parser')\n// parse application/x-www-form-urlencoded\napp.use(bodyParser.urlencoded({ extended: false }))")]),t._v(" "),a("p",[t._v("// parse application/json\napp.use(bodyParser.json())")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("\n\n\n\n\n")])])])])]),t._v(" "),a("h4",{attrs:{id:"express-中使用art-template-模板引擎"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#express-中使用art-template-模板引擎"}},[t._v("#")]),t._v(" express 中使用art-template 模板引擎")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://aui.github.io/art-template/express/",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档 ："),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[a("p",[t._v("安装")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save art-template\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save express-art-template\n")])])])]),t._v(" "),a("li",[a("p",[t._v("使用")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("app.engine 方法安装 模板引擎")])]),t._v(" "),a("li",[a("p",[t._v("res.render（"),a("strong",[t._v("view")]),t._v(" [，locals] [，callback]）")]),t._v(" "),a("p",[t._v("view:文件路径。这可以是绝对路径，也可以是相对于"),a("code",[t._v("views文件夹")]),t._v("的路径")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("engine")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'art'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express-art-template'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使用express-art-template 渲染.art文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// routes")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'views'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'views'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置 渲染文件的 默认路径")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index.art'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        user"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aui'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            tags"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'art'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'template'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'nodejs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),a("h4",{attrs:{id:"处理404"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#处理404"}},[t._v("#")]),t._v(" 处理404")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在最后添加 一个中间件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果没有一个路由 能够匹配 就返回404")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'404.html'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"十三-使用nodemon-监控文件变化并重新运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#十三-使用nodemon-监控文件变化并重新运行"}},[t._v("#")]),t._v(" 十三.使用nodemon 监控文件变化并重新运行")]),t._v(" "),a("p",[t._v("nodemon 可以用来监控代码变化自动重启服务器")]),t._v(" "),a("p",[t._v("安装")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 全局安装")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g nodemon\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者开发时依赖")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save-dev nodemon\n")])])]),a("p",[t._v("使用")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("nodemon app.js\n")])])]),a("h3",{attrs:{id:"十四-crud-json模拟"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#十四-crud-json模拟"}},[t._v("#")]),t._v(" 十四.CRUD  json模拟")]),t._v(" "),a("h4",{attrs:{id:"_1-路由设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-路由设计"}},[t._v("#")]),t._v(" 1.路由设计")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("请求方法")]),t._v(" "),a("th",[t._v("url")]),t._v(" "),a("th",[t._v("get参数")]),t._v(" "),a("th",[t._v("post参数")]),t._v(" "),a("th",[t._v("返回值")]),t._v(" "),a("th",[t._v("备注")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("/student")]),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td",[t._v("html")]),t._v(" "),a("td",[t._v("首页")])]),t._v(" "),a("tr",[a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("/student/info?id=xxx")]),t._v(" "),a("td",[t._v("id")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("学生信息")]),t._v(" "),a("td",[t._v("获取学生信息")])]),t._v(" "),a("tr",[a("td",[t._v("POST")]),t._v(" "),a("td",[t._v("/student/new")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("name,age,gender,hobbies")]),t._v(" "),a("td",[t._v("学生信息")]),t._v(" "),a("td",[t._v("添加学生")])]),t._v(" "),a("tr",[a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("/student/new")]),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td",[t._v("渲染添加学生页面")])]),t._v(" "),a("tr",[a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("/student/edit")]),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td",[t._v("渲染编辑学生页面")])]),t._v(" "),a("tr",[a("td",[t._v("POST")]),t._v(" "),a("td",[t._v("/student/edit")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("id,name,age,gender,hobbies")]),t._v(" "),a("td",[t._v("学生信息")]),t._v(" "),a("td",[t._v("编辑学生")])]),t._v(" "),a("tr",[a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("/student/delete?id=xxx")]),t._v(" "),a("td",[t._v("id")]),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td",[t._v("删除学生")])]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td")])])]),t._v(" "),a("h4",{attrs:{id:"_2-封装路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-封装路由"}},[t._v("#")]),t._v(" 2.封装路由")]),t._v(" "),a("p",[a("strong",[t._v("封装路由逻辑到单独的文件模块，")]),t._v(" "),a("strong",[t._v("模块化")]),t._v("开发")]),t._v(" "),a("p",[t._v("使用"),a("strong",[t._v("express.Router()"),a("strong",[t._v("中间件  ，可以将 路由按照url 封装到 不同文件， 用于")]),t._v("特定的根URL")]),t._v("，模块"),a("strong",[t._v("职责更加单一")]),t._v("，")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//router.js文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建路由容器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" router"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("express"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Router")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//挂载路由")]),t._v("\nrouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//app.js文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" router"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./router.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//把路由容器挂载到app 上")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"_3-封装操作api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-封装操作api"}},[t._v("#")]),t._v(" 3.封装操作API")]),t._v(" "),a("h4",{attrs:{id:"_4-渲染编辑页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-渲染编辑页面"}},[t._v("#")]),t._v(" 4.渲染编辑页面")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\x3c!--type="hidden" 类型的input ，不显示，但随着 表单提交--\x3e')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("{{student.id}}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])]),a("h3",{attrs:{id:"十五-mongodb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#十五-mongodb"}},[t._v("#")]),t._v(" 十五.MongoDB")]),t._v(" "),a("p",[t._v("MongoDB 是 介于  关系数据库和非关系数据库之间 ，关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。")]),t._v(" "),a("p",[t._v("NoSql :not only sql  "),a("strong",[t._v("非关系型 数据库")])]),t._v(" "),a("p",[t._v("关系型数据库：")]),t._v(" "),a("ul",[a("li",[t._v("表 存储关系")]),t._v(" "),a("li",[t._v("通过结构化查询语言（SQL）")]),t._v(" "),a("li",[t._v("提前设计表结构")]),t._v(" "),a("li",[t._v("约束")])]),t._v(" "),a("p",[t._v("非关系型：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("没有声明性查询语言(不使用SQL语句)")])]),t._v(" "),a("li",[a("p",[t._v("没有预定义的模式，表结构，灵活")])]),t._v(" "),a("li")]),t._v(" "),a("p",[t._v("mongoDB是 一种文档 存储，数据存储为一个文档，数据结构由键值(key=>value)对组成，BSON（一种类似于Json）")]),t._v(" "),a("h3",{attrs:{id:"十六-补充知识点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#十六-补充知识点"}},[t._v("#")]),t._v(" 十六.补充知识点")]),t._v(" "),a("h4",{attrs:{id:"_1-path-模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-path-模块"}},[t._v("#")]),t._v(" 1.path 模块")]),t._v(" "),a("p",[t._v("路径操作模块")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("path.dirname(path)")])]),t._v(" "),a("li",[a("p",[t._v("path.extname(path) 获取文件扩展名")])]),t._v(" "),a("li",[a("p",[t._v("path.parse(path)")]),t._v(" "),a("p",[t._v("解析为一个包含信息（base，ext，root，name等等）的对象，")])]),t._v(" "),a("li",[a("p",[t._v("path.join([...paths])")]),t._v(" "),a("p",[t._v("拼接路径，返回正确的路径")]),t._v(" "),a("p",[a("strong",[t._v("用于在文件操作中解决，./ 为执行node 指令 路径 的问题 ，")])])])]),t._v(" "),a("h4",{attrs:{id:"_2-dirname-filename"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-dirname-filename"}},[t._v("#")]),t._v(" 2.___________dirname,_______filename")]),t._v(" "),a("p",[t._v("node的"),a("strong",[t._v("每个模块")]),t._v("，还有属性:___________dirname,_______filename")]),t._v(" "),a("p",[a("strong",[t._v("___dirname :当前模块的目录名")])]),t._v(" "),a("p",[t._v("用于在fs模块使用中，使用绝对路径，读取文件，而不是相对路径")]),t._v(" "),a("p",[t._v("_______filename："),a("strong",[t._v("当前模块")]),t._v("的文件名（绝对路径）")]),t._v(" "),a("p",[a("strong",[t._v("Node 当中的 ./")])]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("__dirname")]),t._v("始终是当前"),a("strong",[t._v("模块文件")]),t._v("所在的目录路径")])]),t._v(" "),a("li",[a("p",[t._v("当您使用"),a("code",[t._v("path")]),t._v("和"),a("code",[t._v("fs")]),t._v("等库时  :  "),a("strong",[t._v(".")]),t._v("     表示终端窗口（即"),a("strong",[t._v("工作目录")]),t._v("）中运行"),a("code",[t._v("node")]),t._v("命令"),a("strong",[t._v("所在目录")]),t._v("    与 process.cwd()  一致")])]),t._v(" "),a("li",[a("p",[t._v("执行  require()，.  表示执行require （） 当前所在的 "),a("strong",[t._v("模块文件")]),t._v("路径")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./test.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"十七-实战项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#十七-实战项目"}},[t._v("#")]),t._v(" 十七.实战项目")]),t._v(" "),a("h4",{attrs:{id:"_1-目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-目录结构"}},[t._v("#")]),t._v(" 1.目录结构")]),t._v(" "),a("h4",{attrs:{id:"_2-路由设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-路由设计"}},[t._v("#")]),t._v(" 2.路由设计")]),t._v(" "),a("h4",{attrs:{id:"_3-表单同步提交和异步提交"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-表单同步提交和异步提交"}},[t._v("#")]),t._v(" 3.表单同步提交和异步提交")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("表单 "),a("strong",[t._v("默认的")]),t._v("同步提交会把响应结果 渲染到页面")]),t._v(" "),a("p",[t._v("ajax诞生之前，就是在"),a("strong",[t._v("原来的")]),t._v("表单提交页面 "),a("strong",[t._v("渲染响应的信息")]),t._v("，")])]),t._v(" "),a("li",[a("p",[t._v("服务端重定向对异步请求无效")])])]),t._v(" "),a("h3",{attrs:{id:"_4-session"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-session"}},[t._v("#")]),t._v(" 4.session")]),t._v(" "),a("p",[t._v("http 是无状态的")]),t._v(" "),a("p",[t._v("cookie：用于保存一些不太敏感的信息，用户名等")]),t._v(" "),a("p",[t._v("session:会话")]),t._v(" "),a("p",[t._v("浏览器第一次访问服务器，"),a("strong",[t._v("服务器会创建一个session")]),t._v("，然后同时为该session生成一个唯一的会话的key,也就是"),a("strong",[t._v("sessionid")]),t._v("，然后，将sessionid及对应的session分别作为key和value保存到缓存中，也可以持久化到数据库中，然后服务器再把sessionid，以cookie的形式发送给客户端。这样浏览器下次再访问时，"),a("strong",[t._v("会直接带着cookie中的sessionid")]),t._v("。然后服务器根据sessionid找到对应的"),a("strong",[t._v("session")]),t._v("进行匹配；")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("使用cookie 管理Session ID")]),t._v(",")])]),t._v(" "),a("p",[t._v("服务端发放Session ID ,客户端存储在cookie中 ，在后面的请求中携带cookie，用于服务端")]),t._v(" "),a("h3",{attrs:{id:"_5-token"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-token"}},[t._v("#")]),t._v(" 5.token")]),t._v(" "),a("p",[t._v("浏览器第一次访问服务器，根据传过来的唯一标识userId，服务端会通过一些算法，如常用的HMAC-SHA256算法，"),a("strong",[t._v("然后加一个密钥，生成一个token，"),a("strong",[t._v("然后通过BASE64编码一下之后将这个token发送给客户端；客户端将token保存起来，"),a("strong",[t._v("下次请求时，带着token")]),t._v("，服务器收到请求后，然后会")]),t._v("用相同的算法和密钥去验证token")]),t._v("，如果通过，执行业务操作，不通过，返回不通过信息")]),t._v(" "),a("p",[t._v("session和token 各有利弊，session 需要在服务器存储状态，token不需要")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("使用jsonwebtoken 模块")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("安装")]),t._v(" "),a("p",[t._v("npm install jsonwebtoken")])]),t._v(" "),a("li",[a("p",[t._v("使用")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("签发token")])]),t._v(" "),a("p",[t._v("jwt.sign(payload, secretOrPrivateKey, [options, callback])")]),t._v(" "),a("p",[a("strong",[t._v("payload")]),t._v("：object/string,      携带的数据，"),a("strong",[t._v("对象会被自动转换为json")])]),t._v(" "),a("p",[a("strong",[t._v("secretOrPrivateKey")]),t._v(" : 密钥，"),a("strong",[t._v("与验证的的时候必须一致")])]),t._v(" "),a("p",[a("strong",[t._v("options")]),t._v("属性")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("algorithm  加密的算法 默认HS256")])]),t._v(" "),a("li",[a("p",[t._v("expiresIn：表示 token 过期的时间 的数字或者描述时间的 字符串  单位 ms")]),t._v(" "),a("p",[t._v("Eg: "),a("code",[t._v("60")]),t._v(", "),a("code",[t._v('"2 days"')]),t._v(", "),a("code",[t._v('"10h"')]),t._v(", "),a("code",[t._v('"7d"')]),t._v("  更多请看 "),a("a",{attrs:{href:"https://github.com/vercel/ms",target:"_blank",rel:"noopener noreferrer"}},[t._v("ms"),a("OutboundLink")],1)])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("验证token")])]),t._v(" "),a("p",[t._v("jwt.verify(token, secretOrPublicKey, [options, "),a("strong",[t._v("callback")]),t._v("])")]),t._v(" "),a("p",[t._v("密钥必须与 签发时一致")])])])])]),t._v(" "),a("p",[t._v("​            callback：（err,"),a("strong",[t._v("payload")]),t._v("） payload 就是之前签发token 时的数据，")]),t._v(" "),a("p",[t._v("如果不通过 验证，err 非空")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//异步 使用")]),t._v("\njwt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("verify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shhhhh'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" decoded")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("decoded"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("foo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// bar")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//同步 使用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" decoded "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jwt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("verify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wrong-secret'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// err")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"_6-中间件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-中间件"}},[t._v("#")]),t._v(" 6.中间件")]),t._v(" "),a("p",[t._v("在NodeJS中，中间件主要是指"),a("strong",[t._v("封装 了对 Http请求 细节的    一些 处理")]),t._v(" "),a("strong",[t._v("方法，函数")])]),t._v(" "),a("p",[t._v("框架 就是由一系列 中间件 构成")]),t._v(" "),a("p",[t._v("用来简化和隔离"),a("strong",[t._v("基础设施与业务逻辑之间的细节")]),t._v("，让开发者能够关注在业务的开发上，以达到提升开发效率的目的。")]),t._v(" "),a("h4",{attrs:{id:"使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("app.use（[path，] "),a("strong",[t._v("callback")]),t._v(" [，callback ...]）")]),t._v(" "),a("p",[t._v("将指定的一个或多个"),a("a",{attrs:{href:"https://www.expressjs.com.cn/guide/using-middleware.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("中间件"),a("OutboundLink")],1),t._v("函数"),a("strong",[t._v("安装在指定的路径")]),t._v("上：当所**请求路径与 path匹配 **时，将执行中间件函数")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("path  "),a("strong",[t._v("默认'/'")])])]),t._v(" "),a("li",[a("p",[t._v("callback 回调函数；可：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("中间件功能。")])]),t._v(" "),a("li",[a("p",[t._v("一系列中间件功能（以逗号分隔）。")])]),t._v(" "),a("li",[a("p",[t._v("一系列中间件功能。")])])])])])])]),t._v(" "),a("h4",{attrs:{id:"express-内置中间件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#express-内置中间件"}},[t._v("#")]),t._v(" express 内置中间件")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("应用级别的 中间件")]),t._v(" "),a("p",[t._v("app.get   app.post   app.put  app.delete 等")])]),t._v(" "),a("li",[a("p",[t._v("路由级别的中间件")]),t._v(" "),a("p",[t._v("express.Router")])]),t._v(" "),a("li",[a("p",[t._v("错误处理中间件")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("express 默认")]),t._v(" "),a("p",[t._v("Express带有内置的错误处理程序，可处理应用程序中可能遇到的任何错误。该默认的错误处理中间件功能已添加到"),a("strong",[t._v("中间件功能堆栈的末尾。")])]),t._v(" "),a("p",[a("strong",[t._v("将错误传递给"),a("code",[t._v("next(err)")]),a("strong",[t._v("您并且未在自定义错误处理程序中")]),t._v("进行处理")]),t._v("，则"),a("strong",[t._v("它将由内置/自定义错误处理程序进行处理")])])]),t._v(" "),a("li",[a("p",[t._v("自定义")])])]),t._v(" "),a("p",[t._v("定义错误处理中间件功能的方式与其他中间件功能相同，只是错误处理功能具有四个参数而不是三个参数 "),a("code",[t._v("(err, req, res, next)")]),t._v(" "),a("strong",[t._v("必须写全 4个")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Something broke!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("内置中间件")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.expressjs.com.cn/en/4x/api.html#express.static",target:"_blank",rel:"noopener noreferrer"}},[t._v("express.static"),a("OutboundLink")],1),t._v("提供静态资产，例如HTML文件，图像等。")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.expressjs.com.cn/en/4x/api.html#express.json",target:"_blank",rel:"noopener noreferrer"}},[t._v("express.json"),a("OutboundLink")],1),t._v("使用JSON负载解析传入的请求。")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.expressjs.com.cn/en/4x/api.html#express.urlencoded",target:"_blank",rel:"noopener noreferrer"}},[t._v("express.urlencoded"),a("OutboundLink")],1),t._v("使用URL编码的有效内容解析传入的请求。")])])]),t._v(" "),a("li",[a("p",[t._v("第三方/自定义中间件")])])]),t._v(" "),a("p",[a("strong",[t._v("function (req,res,next)")])]),t._v(" "),a("p",[t._v("三个参数")]),t._v(" "),a("p",[t._v("req:")]),t._v(" "),a("p",[t._v("res:")]),t._v(" "),a("p",[t._v("next:")]),t._v(" "),a("p",[t._v("一个函数，"),a("strong",[t._v("调用next() 进入下一个中间件")]),t._v("，不调用next()不会调用下一个中间件")]),t._v(" "),a("p",[t._v("调用app.use  添加的 先后顺序 决定调用顺序")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//中间件的定义")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("自定义中间件可以 用来处理请求，如 验证token 等")]),t._v(" "),a("h3",{attrs:{id:"_7-文件上传"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-文件上传"}},[t._v("#")]),t._v(" 7. 文件上传")]),t._v(" "),a("p",[t._v("使用 multer 模块")]),t._v(" "),a("p",[t._v("multer 是 express 官方开发的一个中间件")]),t._v(" "),a("p",[t._v("只会对请求头中"),a("strong",[t._v("携带content-type：multipart/form-data")]),t._v("的请求")]),t._v(" "),a("ul",[a("li",[t._v("基础使用")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" express "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" multer  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'multer'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" upload "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("multer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" dest"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'upload/'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dest：文件保存路径 文件保存在 ./upload 目录下")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 单图上传")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//.single(fieldname)")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/upload'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" upload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("single")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'logo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("ret_code"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//多图上传")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//.array(fieldname[, maxCount])")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/upload'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" upload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'logo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("ret_code"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获取文件信息")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/upload'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" upload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("single")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'logo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//字段如下表格")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n\n")])])]),a("p",[a("strong",[t._v("注")]),t._v(":single（"),a("strong",[t._v("filename")]),t._v("）/array("),a("strong",[t._v("filname")]),t._v(")    "),a("strong",[t._v("传入的filename 要和 form 表单 name 字段一致")])]),t._v(" "),a("p",[t._v("文件信息")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("键")]),t._v(" "),a("th",[t._v("描述")]),t._v(" "),a("th",[t._v("注意")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("fieldname")])]),t._v(" "),a("td",[t._v("表单中指定的字段名称")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("originalname")])]),t._v(" "),a("td",[t._v("用户计算机上文件的名称")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("encoding")])]),t._v(" "),a("td",[t._v("文件的编码类型")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("mimetype")])]),t._v(" "),a("td",[t._v("文件的哑剧类型")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("size")])]),t._v(" "),a("td",[t._v("文件大小（以字节为单位）")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("destination")])]),t._v(" "),a("td",[t._v("文件已保存到的文件夹")]),t._v(" "),a("td",[a("code",[t._v("DiskStorage")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("filename")])]),t._v(" "),a("td",[t._v("文件中的文件名 "),a("code",[t._v("destination")])]),t._v(" "),a("td",[a("code",[t._v("DiskStorage")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("path")])]),t._v(" "),a("td",[t._v("上载文件的完整路径")]),t._v(" "),a("td",[a("code",[t._v("DiskStorage")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("buffer")])]),t._v(" "),a("td",[a("code",[t._v("Buffer")]),t._v("整个文件的A")]),t._v(" "),a("td")])])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("diskStorage")]),t._v(" "),a("p",[t._v("当需要对 文件名和路径进行控制时， 需要使用 diskStorage函数\nmulter.diskStorage 函数， 传入两个选项，返回字符串的函数/字符串")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" storage "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" multer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("diskStorage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    destination"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../public/img/avatar'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("filename")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("email "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("originalname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使用 文件 本来的名称，该名称包含原本的后缀名")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" upload "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("multer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" storage "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("注意： Multer不会为您添加任何文件扩展名")]),t._v("，您的函数应返回带有文件扩展名的完整文件名。")]),t._v(" "),a("p",[t._v("每个函数都会传递请求（"),a("code",[t._v("req")]),t._v("）和有关文件（"),a("code",[t._v("file")]),t._v("）的一些信息，以帮助做出决定。")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);